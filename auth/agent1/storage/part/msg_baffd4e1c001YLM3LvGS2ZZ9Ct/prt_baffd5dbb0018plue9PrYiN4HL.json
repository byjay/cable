{
  "id": "prt_baffd5dbb0018plue9PrYiN4HL",
  "sessionID": "ses_45002da4effeuLE90FrO6HTGi0",
  "messageID": "msg_baffd4e1c001YLM3LvGS2ZZ9Ct",
  "type": "tool",
  "callID": "chatcmpl-tool-377d564d46734a10b7251be965c5b1fd",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/app/opencode-infinite/manager.js"
    },
    "output": "<file>\n00001| import fs from 'fs-extra';\r\n00002| import path from 'path';\r\n00003| import inquirer from 'inquirer';\r\n00004| import { fileURLToPath } from 'url';\r\n00005| \r\n00006| // --- ì„¤ì • ---\r\n00007| const __dirname = path.dirname(fileURLToPath(import.meta.url));\r\n00008| const USER_HOME = process.env.HOME || process.env.USERPROFILE;\r\n00009| \r\n00010| // ì¸ì¦ íŒŒì¼ ì˜ˆìƒ ê²½ë¡œ (ìš°ì„ ìˆœìœ„ ìˆœ)\r\n00011| const POSSIBLE_AUTH_PATHS = [\r\n00012|     path.join(process.env.APPDATA, 'Antigravity', 'User', 'globalStorage', 'storage.json'),\r\n00013|     path.join(process.env.APPDATA, 'Antigravity', 'User', 'globalStorage', 'state.vscdb'),\r\n00014|     path.join(USER_HOME, '.opencode', 'auth_antigravity.json'),\r\n00015|     path.join(USER_HOME, '.opencode', 'storage.json'),\r\n00016|     path.join(USER_HOME, '.opencode', 'auth.json'),\r\n00017|     path.join(USER_HOME, '.opencode', 'session.json')\r\n00018| ];\r\n00019| \r\n00020| let OPENCODE_AUTH_PATH = null;\r\n00021| \r\n00022| const TOKEN_VAULT_DIR = path.join(__dirname, 'tokens');\r\n00023| \r\n00024| // --- ìœ í‹¸ë¦¬í‹° ---\r\n00025| \r\n00026| // ìœ íš¨í•œ ì¸ì¦ íŒŒì¼ ì°¾ê¸°\r\n00027| async function findAuthFile() {\r\n00028|     for (const p of POSSIBLE_AUTH_PATHS) {\r\n00029|         if (await fs.pathExists(p)) {\r\n00030|             return p;\r\n00031|         }\r\n00032|     }\r\n00033|     return null;\r\n00034| }\r\n00035| \r\n00036| // 1. í˜„ì¬ ì„¸ì…˜ ì €ì¥\r\n00037| async function saveCurrentSession(accountName) {\r\n00038|     try {\r\n00039|         if (!OPENCODE_AUTH_PATH) {\r\n00040|             OPENCODE_AUTH_PATH = await findAuthFile();\r\n00041|         }\r\n00042| \r\n00043|         if (OPENCODE_AUTH_PATH) {\r\n00044|             const dest = path.join(TOKEN_VAULT_DIR, `${accountName}.json`);\r\n00045|             await fs.copy(OPENCODE_AUTH_PATH, dest);\r\n00046|             console.log(`âœ… [ì €ì¥ ì™„ë£Œ] í˜„ì¬ ì„¸ì…˜ì´ '${accountName}'(ìœ¼)ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);\r\n00047|             console.log(`   ì›ë³¸ ê²½ë¡œ: ${OPENCODE_AUTH_PATH}`);\r\n00048|             console.log(`   ì €ì¥ ê²½ë¡œ: ${dest}`);\r\n00049|         } else {\r\n00050|             console.error(`âŒ [ì˜¤ë¥˜] ì¸ì¦ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`);\r\n00051|             console.log(`   ê²€ìƒ‰í•œ ê²½ë¡œ:`);\r\n00052|             POSSIBLE_AUTH_PATHS.forEach(p => console.log(`     - ${p}`));\r\n00053|             console.log(\"ğŸ‘‰ ë¨¼ì € ì˜¤í”ˆì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.\");\r\n00054|         }\r\n00055|     } catch (err) {\r\n00056|         console.error('ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', err);\r\n00057|     }\r\n00058| }\r\n00059| \r\n00060| // 2. ì„¸ì…˜ ë¶ˆëŸ¬ì˜¤ê¸°\r\n00061| async function loadSession(accountName) {\r\n00062|     try {\r\n00063|         if (!OPENCODE_AUTH_PATH) {\r\n00064|             OPENCODE_AUTH_PATH = await findAuthFile() || POSSIBLE_AUTH_PATHS[0];\r\n00065|         }\r\n00066| \r\n00067|         const src = path.join(TOKEN_VAULT_DIR, `${accountName}.json`);\r\n00068|         if (await fs.pathExists(src)) {\r\n00069|             const targetDir = path.dirname(OPENCODE_AUTH_PATH);\r\n00070|             await fs.ensureDir(targetDir);\r\n00071| \r\n00072|             await fs.copy(src, OPENCODE_AUTH_PATH);\r\n00073|             console.log(`ğŸ”„ [ë¡œë“œ ì™„ë£Œ] '${accountName}' ê³„ì •ìœ¼ë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.`);\r\n00074|             console.log(`   íƒ€ê²Ÿ íŒŒì¼: ${OPENCODE_AUTH_PATH}`);\r\n00075|             console.log(`ğŸš€ ì´ì œ ì˜¤í”ˆì½”ë“œ(Antigravity)ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”.`);\r\n00076|         } else {\r\n00077|             console.error(`âŒ [ì˜¤ë¥˜] ì €ì¥ëœ í† í°ì´ ì—†ìŠµë‹ˆë‹¤: ${accountName}`);\r\n00078|             const accounts = await listAccounts();\r\n00079|             console.log(\"   ì‚¬ìš© ê°€ëŠ¥í•œ ê³„ì •:\", accounts.join(', '));\r\n00080|         }\r\n00081|     } catch (err) {\r\n00082|         console.error('ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', err);\r\n00083|     }\r\n00084| }\r\n00085| \r\n00086| // 3. ê³„ì • ëª©ë¡\r\n00087| async function listAccounts() {\r\n00088|     if (!await fs.pathExists(TOKEN_VAULT_DIR)) return [];\r\n00089|     const files = await fs.readdir(TOKEN_VAULT_DIR);\r\n00090|     return files.filter(file => file.endsWith('.json')).map(file => file.replace('.json', ''));\r\n00091| }\r\n00092| \r\n00093| // --- ë©”ì¸ í•¨ìˆ˜ ---\r\n00094| async function main() {\r\n00095|     console.log(\"\\n============================================\");\r\n00096|     console.log(\"   ğŸ§   CLAUDE 4.5 THINKING UNLIMITED  ğŸ§    \");\r\n00097|     console.log(\"   >> DesignSir System Activated            \");\r\n00098|     console.log(\"============================================\\n\");\r\n00099| \r\n00100|     const args = process.argv.slice(2);\r\n00101|     const command = args[0];\r\n00102|     const param = args[1];\r\n00103| \r\n00104|     // í”„ë¦¬ì…‹ ê³„ì • ëª©ë¡\r\n00105|     const PRESETS = [\r\n00106|         'designsir101@gmail.com',\r\n00107|         'designsir102@gmail.com',\r\n00108|         'designsir103@gmail.com',\r\n00109|         'designsir104@gmail.com',\r\n00110|         'designsir105@gmail.com',\r\n00111|         'designsir106@gmail.com',\r\n00112|         'designsir107@gmail.com',\r\n00113|         'designsir2@gmail.com',\r\n00114|         'elecgisanim@gmail.com',\r\n00115|         'elecgisanim1@gmail.com'\r\n00116|     ];\r\n00117| \r\n00118|     if (command === 'save') {\r\n00119|         if (!param) {\r\n00120|             console.log(\"ì‚¬ìš©ë²•: node manager.js save <ë³„ì¹­>\");\r\n00121|         } else {\r\n00122|             await saveCurrentSession(param);\r\n00123|         }\r\n00124|     } else if (command === 'load') {\r\n00125|         const accounts = await listAccounts();\r\n00126|         if (!param) {\r\n00127|             if (accounts.length === 0) {\r\n00128|                 console.log(\"âŒ ì €ì¥ëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤. 'ì„¤ì • ë§ˆë²•ì‚¬'ë¥¼ ë¨¼ì € ì‹¤í–‰í•´ì£¼ì„¸ìš”.\");\r\n00129|             } else {\r\n00130|                 const { name } = await inquirer.prompt([{\r\n00131|                     type: 'list',\r\n00132|                     name: 'name',\r\n00133|                     message: 'ì „í™˜í•  ê³„ì •ì„ ì„ íƒí•˜ì„¸ìš”:',\r\n00134|                     choices: accounts\r\n00135|                 }]);\r\n00136|                 await loadSession(name);\r\n00137|             }\r\n00138|         } else {\r\n00139|             await loadSession(param);\r\n00140|         }\r\n00141|     } else if (command === 'list') {\r\n00142|         const accounts = await listAccounts();\r\n00143|         console.log(\"ì €ì¥ëœ ê³„ì • ëª©ë¡:\");\r\n00144|         accounts.forEach(acc => console.log(` - ${acc}`));\r\n00145| \r\n00146|     } else if (command === 'rotate') {\r\n00147|         // --- ìˆœí™˜(Rotate) ë¡œì§ ---\r\n00148|         const accounts = await listAccounts();\r\n00149|         if (accounts.length === 0) {\r\n00150|             console.log(\"âŒ ì €ì¥ëœ ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n00151|             return;\r\n00152|         }\r\n00153| \r\n00154|         // í˜„ì¬ ì–´ë–¤ ê³„ì •ì´ ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ì´ ì–´ë ¤ìš°ë¯€ë¡œ (íŒŒì¼ ë‚´ìš© ë¹„êµëŠ” ë³µì¡)\r\n00155|         // ë³„ë„ì˜ ìƒíƒœ íŒŒì¼(current_session.txt)ì„ ë§Œë“¤ì–´ ì¶”ì í•˜ê±°ë‚˜, \r\n00156|         // ë‹¨ìˆœíˆ \"ë‹¤ìŒ ê³„ì •\"ì„ ë¬»ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„.\r\n00157|         // ì—¬ê¸°ì„œëŠ” ê°€ì¥ ì§ê´€ì ìœ¼ë¡œ: \"ëª©ë¡ ìˆœì„œëŒ€ë¡œ ë‹¤ìŒ ê±° ë¬´ì¡°ê±´ ë¡œë“œ\" (ëœë¤ ì•„ë‹˜)\r\n00158| \r\n00159|         // ìƒíƒœ íŒŒì¼ ê²½ë¡œ\r\n00160|         const stateFile = path.join(TOKEN_VAULT_DIR, 'last_rotated.txt');\r\n00161|         let lastIdx = -1;\r\n00162| \r\n00163|         if (await fs.pathExists(stateFile)) {\r\n00164|             const lastAccount = (await fs.readFile(stateFile, 'utf-8')).trim();\r\n00165|             lastIdx = accounts.indexOf(lastAccount);\r\n00166|         }\r\n00167| \r\n00168|         // ë‹¤ìŒ ì¸ë±ìŠ¤ ê³„ì‚°\r\n00169|         let nextIdx = lastIdx + 1;\r\n00170|         if (nextIdx >= accounts.length) {\r\n00171|             nextIdx = 0; // ëì— ë‹¤ë‹¤ë¥´ë©´ ì²˜ìŒìœ¼ë¡œ\r\n00172|         }\r\n00173| \r\n00174|         const nextAccount = accounts[nextIdx];\r\n00175|         console.log(`ğŸ”„ ìˆœí™˜ ëª¨ë“œ: ${nextAccount} ê³„ì •ìœ¼ë¡œ êµì²´í•©ë‹ˆë‹¤...`);\r\n00176| \r\n00177|         await loadSession(nextAccount);\r\n00178| \r\n00179|         // ìƒíƒœ ì €ì¥\r\n00180|         await fs.writeFile(stateFile, nextAccount, 'utf-8');\r\n00181| \r\n00182|     } else if (command === 'setup-preset') {\r\n00183|         // --- í”„ë¦¬ì…‹ ì „ìš© ì„¤ì • ë§ˆë²•ì‚¬ ---\r\n00184|         console.log(\"ğŸ§™â€â™‚ï¸ [í”„ë¦¬ì…‹ ëª¨ë“œ] 10ê°œ í”„ë¦¬ì…‹ ê³„ì • ì„¤ì •ì„ ì‹œì‘í•©ë‹ˆë‹¤.\");\r\n00185| \r\n00186|         for (const email of PRESETS) {\r\n00187|             console.log(`\\n--------------------------------------------`);\r\n00188|             console.log(`Target: [ ${email} ]`);\r\n00189|             console.log(`--------------------------------------------`);\r\n00190| \r\n00191|             // íŒŒì¼ì´ ì´ë¯¸ ìˆìœ¼ë©´ ë¬¼ì–´ë³´ê¸°\r\n00192|             const dest = path.join(TOKEN_VAULT_DIR, `${email}.json`);\r\n00193|             if (await fs.pathExists(dest)) {\r\n00194|                 console.log(`â„¹ï¸  ${email} í† í°ì´ ì´ë¯¸ ìˆìŠµë‹ˆë‹¤. ê±´ë„ˆë›¸ê¹Œìš”?`);\r\n00195|                 const { skip } = await inquirer.prompt([{\r\n00196|                     type: 'confirm',\r\n00197|                     name: 'skip',\r\n00198|                     message: 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í† í°ì…ë‹ˆë‹¤. ê±´ë„ˆë›°ì‹œê² ìŠµë‹ˆê¹Œ? (ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ë ¤ë©´ n)',\r\n00199|                     default: true\r\n00200|                 }]);\r\n00201|                 if (skip) continue;\r\n00202|             }\r\n00203| \r\n00204|             console.log(`\\nğŸš¨ [ì¤‘ìš”: ë¡œê·¸ì¸ ì°½ì€ ì§ì ‘ ë„ì›Œì•¼ í•©ë‹ˆë‹¤!] ğŸš¨`);\r\n00205|             console.log(`í”„ë¡œê·¸ë¨ì´ ìë™ìœ¼ë¡œ êµ¬ê¸€ ë¡œê·¸ì¸ ì°½ì„ ë„ìš¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);\r\n00206|             console.log(`\\nğŸ‘‰ ì§ì ‘ í•˜ì‹¤ ì¼:`);\r\n00207|             console.log(`1. ë°”íƒ•í™”ë©´ì˜ [OpenCode] ë˜ëŠ” [VS Code] ì‹¤í–‰`);\r\n00208|             console.log(`2. í”„ë¡œê·¸ë¨ ì•ˆì—ì„œ [Antigravity] ì•„ì´ì½˜ í´ë¦­ -> ë¡œê·¸ì¸`);\r\n00209|             console.log(`3. [ ${email} ] ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸`);\r\n00210|             console.log(`4. ê·¸ ë‹¤ìŒ, ì—¬ê¸°ì„œ ì—”í„°!`);\r\n00211| \r\n00212|             await inquirer.prompt([{ type: 'input', name: 'dummy', message: 'ë¡œê·¸ì¸ì„ ì™„ë£Œí–ˆë‹¤ë©´ ì—”í„°ë¥¼ ëˆ„ë¥´ì„¸ìš”...' }]);\r\n00213|             await saveCurrentSession(email);\r\n00214|         }\r\n00215|         console.log(\"\\nâœ… ëª¨ë“  í”„ë¦¬ì…‹ ê³„ì • ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\");\r\n00216| \r\n00217|     } else if (command === 'setup') {\r\n00218|         console.log(\"ğŸ§™â€â™‚ï¸ ì„¤ì • ë§ˆë²•ì‚¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...\");\r\n00219| \r\n00220|         // í”„ë¦¬ì…‹ ì‚¬ìš© ì—¬ë¶€ ë¬»ê¸°\r\n00221|         const { usePreset } = await inquirer.prompt([{\r\n00222|             type: 'confirm',\r\n00223|             name: 'usePreset',\r\n00224|             message: 'í”„ë¦¬ì…‹(10ê°œ) ê³„ì •ì„ ìë™ìœ¼ë¡œ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',\r\n00225|             default: true\r\n00226|         }]);\r\n00227| \r\n00228|         if (usePreset) {\r\n00229|             // í”„ë¦¬ì…‹ ì»¤ë§¨ë“œë¡œ ì¬ê·€ í˜¸ì¶œ\r\n00230|             process.argv[2] = 'setup-preset';\r\n00231|             await main();\r\n00232|             return;\r\n00233|         }\r\n00234| \r\n00235|         console.log(\"ì´ ë§ˆë²•ì‚¬ëŠ” êµ¬ê¸€ ê³„ì •ë“¤ì„ í•˜ë‚˜ì”© ë“±ë¡í•˜ë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.\\n\");\r\n00236|         const { count } = await inquirer.prompt([{\r\n00237|             type: 'number',\r\n00238|             name: 'count',\r\n00239|             message: 'ì„¤ì •í•  êµ¬ê¸€ ê³„ì •ì´ ì´ ëª‡ ê°œì¸ê°€ìš”?',\r\n00240|             default: 2\r\n00241|         }]);\r\n00242| \r\n00243|         for (let i = 1; i <= count; i++) {\r\n00244|             console.log(`\\n--- ê³„ì • ${i} / ${count} ---`);\r\n00245|             const { googleId } = await inquirer.prompt([{\r\n00246|                 type: 'input',\r\n00247|                 name: 'googleId',\r\n00248|                 message: `ê³„ì • ì´ë©”ì¼ ì…ë ¥:`,\r\n00249|                 validate: input => input ? true : 'ì…ë ¥ í•„ìˆ˜'\r\n00250|             }]);\r\n00251| \r\n00252|             console.log(`1. ì˜¤í”ˆì½”ë“œ ì‹¤í–‰ -> 2. ${googleId} ì§ì ‘ ë¡œê·¸ì¸ -> 3.ì™„ë£Œ í›„ ì—”í„°`);\r\n00253|             await inquirer.prompt([{ type: 'input', name: 'c', message: 'ë¡œê·¸ì¸ì„ ì™„ë£Œí–ˆë‹¤ë©´ ì—”í„°ë¥¼ ëˆ„ë¥´ì„¸ìš”...' }]);\r\n00254|             await saveCurrentSession(googleId);\r\n00255|         }\r\n00256|         console.log(\"\\nâœ… ì„¤ì • ì™„ë£Œ!\");\r\n00257| \r\n00258|     } else {\r\n00259|         // ëŒ€í™”í˜• ëª¨ë“œ\r\n00260|         const { action } = await inquirer.prompt([\r\n00261|             {\r\n00262|                 type: 'list',\r\n00263|                 name: 'action',\r\n00264|                 message: 'ë©”ë‰´ ì„ íƒ:',\r\n00265|                 choices: [\r\n00266|                     { name: 'ğŸ”„ ìˆœí™˜ (ë‹¤ìŒ ê³„ì •ìœ¼ë¡œ êµì²´)', value: 'rotate' },\r\n00267|                     { name: 'ğŸ“‚ ì €ì¥ëœ ê³„ì • ëª©ë¡ ë³´ê¸°', value: 'list' },\r\n00268|                     { name: 'ğŸª„  ì´ˆê¸° ì„¤ì • (ë§ˆë²•ì‚¬)', value: 'setup' },\r\n00269|                     { name: 'âŒ ì¢…ë£Œ', value: 'exit' }\r\n00270|                 ]\r\n00271|             }\r\n00272|         ]);\r\n00273| \r\n00274|         if (action === 'rotate') {\r\n00275|             process.argv[2] = 'rotate';\r\n00276|             await main();\r\n00277|         } else if (action === 'list') {\r\n00278|             // ... (ê¸°ì¡´ ë¡œì§ ì¬ì‚¬ìš© ë˜ëŠ” í˜¸ì¶œ)\r\n00279|             const accounts = await listAccounts();\r\n00280|             console.log(\"=== ëª©ë¡ ===\");\r\n00281|             accounts.forEach(a => console.log(a));\r\n00282|         } else if (action === 'setup') {\r\n00283|             process.argv[2] = 'setup';\r\n00284|             await main();\r\n00285|         }\r\n00286|     }\r\n00287| }\r\n00288| \r\n00289| main();\r\n00290| \n\n(End of file - total 290 lines)\n</file>",
    "title": "app/opencode-infinite/manager.js",
    "metadata": {
      "preview": "import fs from 'fs-extra';\r\nimport path from 'path';\r\nimport inquirer from 'inquirer';\r\nimport { fileURLToPath } from 'url';\r\n\r\n// --- ì„¤ì • ---\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\r\nconst USER_HOME = process.env.HOME || process.env.USERPROFILE;\r\n\r\n// ì¸ì¦ íŒŒì¼ ì˜ˆìƒ ê²½ë¡œ (ìš°ì„ ìˆœìœ„ ìˆœ)\r\nconst POSSIBLE_AUTH_PATHS = [\r\n    path.join(process.env.APPDATA, 'Antigravity', 'User', 'globalStorage', 'storage.json'),\r\n    path.join(process.env.APPDATA, 'Antigravity', 'User', 'globalStorage', 'state.vscdb'),\r\n    path.join(USER_HOME, '.opencode', 'auth_antigravity.json'),\r\n    path.join(USER_HOME, '.opencode', 'storage.json'),\r\n    path.join(USER_HOME, '.opencode', 'auth.json'),\r\n    path.join(USER_HOME, '.opencode', 'session.json')\r\n];\r\n\r\nlet OPENCODE_AUTH_PATH = null;\r",
      "truncated": false
    },
    "time": {
      "start": 1768184176066,
      "end": 1768184176084
    }
  }
}