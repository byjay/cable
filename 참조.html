<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEASTAR Ultimate Cable Management System Pro+ 2024</title>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.9/dat.gui.min.js"></script>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #ffffff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%);
            color: white;
            padding: 20px 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border-bottom: 3px solid #2563eb;
        }

        .header h1 {
            margin: 0 0 8px;
            font-size: 32px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 400;
        }

        .main-content {
            flex: 1;
            display: flex;
            height: calc(100vh - 140px);
        }

        .sidebar {
            width: 350px;
            background: rgba(15, 23, 42, 0.95);
            border-right: 2px solid #334155;
            padding: 20px;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-navigation {
            display: flex;
            background: rgba(30, 41, 59, 0.9);
            border-bottom: 2px solid #475569;
            padding: 0;
            overflow-x: auto;
        }

        .tab-button {
            padding: 15px 25px;
            background: transparent;
            color: #cbd5e1;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab-button:hover {
            background: rgba(59, 130, 246, 0.2);
            color: #ffffff;
        }

        .tab-button.active {
            background: rgba(59, 130, 246, 0.3);
            color: #ffffff;
            border-bottom-color: #3b82f6;
        }

        .tab-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(5px);
        }

        .section {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #475569;
            backdrop-filter: blur(10px);
        }

        .section h3 {
            color: #60a5fa;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }

        .file-input-group {
            margin-bottom: 15px;
        }

        .file-input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #e2e8f0;
        }

        .file-input, select, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #475569;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.8);
            color: #ffffff;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .file-input:focus, select:focus, input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #4b5563, #374151);
            transform: translateY(-1px);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #1e293b, #334155);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #475569;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 28px;
            font-weight: 700;
            color: #60a5fa;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #cbd5e1;
            font-weight: 500;
        }

        .table-container {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #475569;
            max-height: 600px;
            overflow-y: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .data-table th {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            cursor: pointer;
        }

        .data-table th:hover {
            background: linear-gradient(135deg, #1d4ed8, #2563eb);
        }

        .data-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #334155;
            color: #e2e8f0;
        }

        .data-table tbody tr:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #334155;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            width: 0%;
            transition: width 0.3s ease;
        }

        .chart-container {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #475569;
        }

        .threejs-container {
            width: 100%;
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #475569;
            background: #000000;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
            max-width: 400px;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .notification.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .hidden {
            display: none !important;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #334155;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: #10b981;
            color: white;
        }

        .badge-warning {
            background: #f59e0b;
            color: white;
        }

        .badge-danger {
            background: #ef4444;
            color: white;
        }

        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                height: auto;
            }

            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 2px solid #334155;
            }

            .header h1 {
                font-size: 24px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .control-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <header class="header">
            <h1>üö¢ SEASTAR Ultimate Cable Management System Pro+ 2024</h1>
            <div class="subtitle">ÏôÑÎ≤ΩÌïú ÏºÄÏù¥Î∏î Í¥ÄÎ¶¨, 3D ÏãúÍ∞ÅÌôî, Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù Î∞è Î¨ºÎüâ ÏÇ∞Ï∂ú ÌÜµÌï© ÏãúÏä§ÌÖú | Ï¥ù 636Í∞ú ÏºÄÏù¥Î∏î ¬∑ 141Í∞ú ÎÖ∏Îìú</div>
        </header>

        <div class="main-content">
            <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
            <aside class="sidebar">
                <div class="section">
                    <h3>üìÅ ÌååÏùº ÏóÖÎ°úÎìú</h3>
                    <div class="file-input-group">
                        <label for="cableFile">ÏºÄÏù¥Î∏î Î¶¨Ïä§Ìä∏ ÌååÏùº (Excel/CSV)</label>
                        <input type="file" id="cableFile" class="file-input" accept=".xlsx,.xls,.csv">
                    </div>
                    <div class="file-input-group">
                        <label for="nodeFile">ÎÖ∏Îìú Ï†ïÎ≥¥ ÌååÏùº (Excel/CSV)</label>
                        <input type="file" id="nodeFile" class="file-input" accept=".xlsx,.xls,.csv">
                    </div>
                    <button class="btn btn-primary" onclick="loadFiles()" style="width:100%;margin-bottom:10px;">ÌååÏùº Î°úÎìú</button>
                    <button class="btn btn-secondary" onclick="loadSampleData()" style="width:100%;">ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Î°úÎìú</button>
                </div>

                <div class="section">
                    <h3>üìä ÏãúÏä§ÌÖú ÌÜµÍ≥Ñ</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalCables">636</div>
                            <div class="stat-label">Ï¥ù ÏºÄÏù¥Î∏î</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalNodes">141</div>
                            <div class="stat-label">Ï¥ù ÎÖ∏Îìú</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="cableTypes">54</div>
                            <div class="stat-label">ÏºÄÏù¥Î∏î ÌÉÄÏûÖ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalLength">3953.0</div>
                            <div class="stat-label">Ï¥ù Í∏∏Ïù¥ (m)</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>üéõÔ∏è Ï†úÏñ¥ Ìå®ÎÑê</h3>
                    <div style="display:flex;flex-direction:column;gap:10px;">
                        <button class="btn btn-secondary" onclick="refreshAll()">Ï†ÑÏ≤¥ ÏÉàÎ°úÍ≥†Ïπ®</button>
                        <button class="btn btn-success" onclick="exportData()">Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                        <button class="btn btn-warning" onclick="runAllTests()">ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏</button>
                        <button class="btn btn-danger" onclick="resetSystem()">ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî</button>
                    </div>
                </div>

                <div class="section">
                    <h3>üîç Îπ†Î•∏ Í≤ÄÏÉâ</h3>
                    <input type="text" id="quickSearch" placeholder="ÏºÄÏù¥Î∏îÎ™Ö, ÎÖ∏ÎìúÎ™Ö Í≤ÄÏÉâ..." onkeyup="quickSearch()" style="margin-bottom:10px;">
                    <div id="quickSearchResults" style="max-height:200px;overflow-y:auto;"></div>
                </div>
            </aside>

            <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
            <main class="content-area">
                <nav class="tab-navigation">
                    <button class="tab-button active" onclick="showTab('dashboard')">üìä ÎåÄÏãúÎ≥¥Îìú</button>
                    <button class="tab-button" onclick="showTab('cables')">üîå ÏºÄÏù¥Î∏î Î™©Î°ù</button>
                    <button class="tab-button" onclick="showTab('nodes')">üèóÔ∏è ÎÖ∏Îìú Ï†ïÎ≥¥</button>
                    <button class="tab-button" onclick="showTab('types')">üìã ÌÉÄÏûÖÎ≥Ñ Î∂ÑÏÑù</button>
                    <button class="tab-button" onclick="showTab('3d')">üåê 3D ÏãúÍ∞ÅÌôî</button>
                    <button class="tab-button" onclick="showTab('routing')">üó∫Ô∏è Í≤ΩÎ°ú Í¥ÄÎ¶¨</button>
                    <button class="tab-button" onclick="showTab('quantity')">üìà Î¨ºÎüâ ÏÇ∞Ï∂ú</button>
                </nav>
                <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†Îì§ -->
                <div id="dashboard" class="tab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="dashTotalCables">636</div>
                            <div class="stat-label">Ï¥ù ÏºÄÏù¥Î∏î Ïàò</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="dashTotalNodes">141</div>
                            <div class="stat-label">Ï¥ù ÎÖ∏Îìú Ïàò</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="dashCableTypes">54</div>
                            <div class="stat-label">ÏºÄÏù¥Î∏î ÌÉÄÏûÖ Ïàò</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="dashTotalLength">3953.0</div>
                            <div class="stat-label">Ï¥ù ÏºÄÏù¥Î∏î Í∏∏Ïù¥ (m)</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>ÏãúÏä§ÌÖúÎ≥Ñ ÏºÄÏù¥Î∏î Î∂ÑÌè¨</h3>
                        <canvas id="systemChart" width="400" height="200"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>ÏºÄÏù¥Î∏î ÌÉÄÏûÖÎ≥Ñ Î∂ÑÌè¨</h3>
                        <canvas id="typeChart" width="400" height="200"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>ÎÖ∏Îìú Ïó∞Í≤∞ ÌÜµÍ≥Ñ</h3>
                        <canvas id="nodeChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <div id="cables" class="tab-content hidden">
                    <div class="section">
                        <h3>üîå ÏºÄÏù¥Î∏î Î™©Î°ù Í¥ÄÎ¶¨</h3>
                        <div class="control-panel">
                            <input type="text" id="cableSearch" placeholder="ÏºÄÏù¥Î∏îÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ..." onkeyup="searchCables()">
                            <select id="systemFilter" onchange="filterCables()">
                                <option value="">Î™®Îì† ÏãúÏä§ÌÖú</option>
                            </select>
                            <select id="typeFilter" onchange="filterCables()">
                                <option value="">Î™®Îì† ÌÉÄÏûÖ</option>
                            </select>
                            <button class="btn btn-success" onclick="exportCableList()">ÏºÄÏù¥Î∏î Î™©Î°ù ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table" id="cableTable">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('cableTable', 0)">ÏºÄÏù¥Î∏îÎ™Ö ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 1)">ÌÉÄÏûÖ ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 2)">ÏãúÏä§ÌÖú ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 3)">FROM ÎÖ∏Îìú ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 4)">TO ÎÖ∏Îìú ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 5)">Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th onclick="sortTable('cableTable', 6)">ÏïÑÏõÉ Îã§Ïù¥Ïñ¥ ‚Üï</th>
                                    <th>Ïï°ÏÖò</th>
                                </tr>
                            </thead>
                            <tbody id="cableTableBody">
                                <!-- ÏºÄÏù¥Î∏î Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="nodes" class="tab-content hidden">
                    <div class="section">
                        <h3>üèóÔ∏è ÎÖ∏Îìú Ï†ïÎ≥¥ Í¥ÄÎ¶¨</h3>
                        <div class="control-panel">
                            <input type="text" id="nodeSearch" placeholder="ÎÖ∏ÎìúÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ..." onkeyup="searchNodes()">
                            <button class="btn btn-primary" onclick="calculateNodeUtilization()">ÎÖ∏Îìú Ïù¥Ïö©Î•† Í≥ÑÏÇ∞</button>
                            <button class="btn btn-success" onclick="exportNodeInfo()">ÎÖ∏Îìú Ï†ïÎ≥¥ ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                            <button class="btn btn-secondary" onclick="show3DNetwork()">3D ÎÑ§Ìä∏ÏõåÌÅ¨ Î≥¥Í∏∞</button>
                        </div>
                    </div>

                    <div class="stats-grid" id="nodeStatsGrid">
                        <!-- ÎÖ∏Îìú ÌÜµÍ≥ÑÍ∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>

                    <div class="table-container">
                        <table class="data-table" id="nodeTable">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('nodeTable', 0)">ÎÖ∏ÎìúÎ™Ö ‚Üï</th>
                                    <th onclick="sortTable('nodeTable', 1)">Ïó∞Í≤∞Îêú ÏºÄÏù¥Î∏î Ïàò ‚Üï</th>
                                    <th onclick="sortTable('nodeTable', 2)">Ï¥ù Îã®Î©¥Ï†Å (mm¬≤) ‚Üï</th>
                                    <th onclick="sortTable('nodeTable', 3)">Ïó∞Í≤∞ Í¥ÄÍ≥Ñ ‚Üï</th>
                                    <th onclick="sortTable('nodeTable', 4)">ÎßÅÌÅ¨ Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th>ÏÉÅÏÑ∏Î≥¥Í∏∞</th>
                                </tr>
                            </thead>
                            <tbody id="nodeTableBody">
                                <!-- ÎÖ∏Îìú Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="types" class="tab-content hidden">
                    <div class="section">
                        <h3>üìã ÏºÄÏù¥Î∏î ÌÉÄÏûÖÎ≥Ñ Î∂ÑÏÑù</h3>
                        <div class="control-panel">
                            <select id="typeAnalysisFilter">
                                <option value="all">Î™®Îì† ÌÉÄÏûÖ</option>
                            </select>
                            <button class="btn btn-primary" onclick="analyzeTypes()">ÌÉÄÏûÖ Î∂ÑÏÑù</button>
                            <button class="btn btn-success" onclick="exportTypeAnalysis()">Î∂ÑÏÑù Í≤∞Í≥º ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>ÌÉÄÏûÖÎ≥Ñ ÏÇ¨Ïö©Îüâ Î∞è Ïä§ÌÇ® Î≤àÌò∏ Î∂ÑÏÑù</h3>
                        <canvas id="typeAnalysisChart" width="400" height="200"></canvas>
                    </div>

                    <div class="table-container">
                        <table class="data-table" id="typeTable">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('typeTable', 0)">ÏºÄÏù¥Î∏î ÌÉÄÏûÖ ‚Üï</th>
                                    <th onclick="sortTable('typeTable', 1)">ÏÇ¨Ïö©Îüâ ‚Üï</th>
                                    <th onclick="sortTable('typeTable', 2)">Ïä§ÌÇ® Î≤àÌò∏ Î≤îÏúÑ ‚Üï</th>
                                    <th onclick="sortTable('typeTable', 3)">ÌèâÍ∑† Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th onclick="sortTable('typeTable', 4)">Ï¥ù Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th onclick="sortTable('typeTable', 5)">ÌèâÍ∑† ÏïÑÏõÉ Îã§Ïù¥Ïñ¥ ‚Üï</th>
                                    <th>ÏÉÅÏÑ∏Î≥¥Í∏∞</th>
                                </tr>
                            </thead>
                            <tbody id="typeTableBody">
                                <!-- ÌÉÄÏûÖÎ≥Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="3d" class="tab-content hidden">
                    <div class="section">
                        <h3>üåê 3D ÎÑ§Ìä∏ÏõåÌÅ¨ ÏãúÍ∞ÅÌôî</h3>
                        <div class="control-panel">
                            <button class="btn btn-primary" onclick="initialize3D()">3D Ï¥àÍ∏∞Ìôî</button>
                            <button class="btn btn-secondary" onclick="reset3DView()">Î∑∞ Î¶¨ÏÖã</button>
                            <button class="btn btn-success" onclick="export3DData()">3D Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•</button>
                            <label>
                                ÎÖ∏Îìú ÌëúÏãú:
                                <input type="checkbox" id="showNodes" checked onchange="toggle3DNodes()">
                            </label>
                            <label>
                                ÏºÄÏù¥Î∏î ÌëúÏãú:
                                <input type="checkbox" id="showCables" checked onchange="toggle3DCables()">
                            </label>
                        </div>
                    </div>

                    <div class="threejs-container" id="threejsContainer">
                        <!-- 3D ÏãúÍ∞ÅÌôîÍ∞Ä Ïó¨Í∏∞Ïóê Î†åÎçîÎßÅÎê©ÎãàÎã§ -->
                    </div>

                    <div class="section">
                        <h3>3D Î∑∞ Ïª®Ìä∏Î°§</h3>
                        <div class="control-panel">
                            <label>XÏ∂ï ÌöåÏ†Ñ: <input type="range" id="rotationX" min="0" max="360" value="0" onchange="update3DRotation()"></label>
                            <label>YÏ∂ï ÌöåÏ†Ñ: <input type="range" id="rotationY" min="0" max="360" value="0" onchange="update3DRotation()"></label>
                            <label>ZÏ∂ï ÌöåÏ†Ñ: <input type="range" id="rotationZ" min="0" max="360" value="0" onchange="update3DRotation()"></label>
                            <label>Ï§å Î†àÎ≤®: <input type="range" id="zoomLevel" min="0.1" max="5" step="0.1" value="1" onchange="update3DZoom()"></label>
                        </div>
                    </div>
                </div>

                <div id="routing" class="tab-content hidden">
                    <div class="section">
                        <h3>üó∫Ô∏è ÏºÄÏù¥Î∏î Í≤ΩÎ°ú Í¥ÄÎ¶¨</h3>
                        <div class="control-panel">
                            <select id="cableSelect">
                                <option value="">ÏºÄÏù¥Î∏î ÏÑ†ÌÉù</option>
                            </select>
                            <button class="btn btn-primary" onclick="showCableRoute()">Í≤ΩÎ°ú ÌëúÏãú</button>
                            <button class="btn btn-secondary" onclick="editCableRoute()">Í≤ΩÎ°ú Ìé∏Ïßë</button>
                            <button class="btn btn-success" onclick="saveCableRoute()">Í≤ΩÎ°ú Ï†ÄÏû•</button>
                        </div>
                    </div>

                    <div class="section">
                        <h3>Í≤ΩÎ°ú Î≥ÄÍ≤Ω ÎèÑÍµ¨</h3>
                        <div class="control-panel">
                            <input type="text" id="newFromNode" placeholder="ÏÉà ÏãúÏûë ÎÖ∏Îìú">
                            <input type="text" id="newToNode" placeholder="ÏÉà Ï¢ÖÎ£å ÎÖ∏Îìú">
                            <input type="number" id="newLength" placeholder="ÏÉà Í∏∏Ïù¥ (m)" step="0.1">
                            <button class="btn btn-warning" onclick="changeRoute()">Í≤ΩÎ°ú Î≥ÄÍ≤Ω</button>
                            <button class="btn btn-danger" onclick="revertRoute()">Î≥ÄÍ≤Ω Ï∑®ÏÜå</button>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="data-table" id="routeTable">
                            <thead>
                                <tr>
                                    <th>ÏºÄÏù¥Î∏îÎ™Ö</th>
                                    <th>ÌòÑÏû¨ Í≤ΩÎ°ú</th>
                                    <th>Í∏∏Ïù¥ (m)</th>
                                    <th>Í≤ΩÏú† ÎÖ∏Îìú</th>
                                    <th>ÏÉÅÌÉú</th>
                                    <th>Ïï°ÏÖò</th>
                                </tr>
                            </thead>
                            <tbody id="routeTableBody">
                                <!-- Í≤ΩÎ°ú Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="quantity" class="tab-content hidden">
                    <div class="section">
                        <h3>üìà ÏºÄÏù¥Î∏î Î¨ºÎüâ ÏÇ∞Ï∂ú</h3>
                        <div class="control-panel">
                            <button class="btn btn-primary" onclick="calculateQuantities()">Î¨ºÎüâ Í≥ÑÏÇ∞</button>
                            <button class="btn btn-success" onclick="exportQuantityReport()">Î¨ºÎüâ Î≥¥Í≥†ÏÑú ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                            <button class="btn btn-secondary" onclick="generatePOSReport()">POS Î≥¥Í≥†ÏÑú ÏÉùÏÑ±</button>
                        </div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalCableLength">3953.0</div>
                            <div class="stat-label">Ï¥ù ÏºÄÏù¥Î∏î Í∏∏Ïù¥ (m)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalWeight">0</div>
                            <div class="stat-label">Ï¥ù Î¨¥Í≤å (kg)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalCost">0</div>
                            <div class="stat-label">ÏòàÏÉÅ ÎπÑÏö© (Ïõê)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="uniqueTypes">54</div>
                            <div class="stat-label">Í≥†Ïú† ÌÉÄÏûÖ Ïàò</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>ÌÉÄÏûÖÎ≥Ñ Î¨ºÎüâ Î∂ÑÌè¨</h3>
                        <canvas id="quantityChart" width="400" height="200"></canvas>
                    </div>

                    <div class="table-container">
                        <table class="data-table" id="quantityTable">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('quantityTable', 0)">ÏºÄÏù¥Î∏î ÌÉÄÏûÖ ‚Üï</th>
                                    <th onclick="sortTable('quantityTable', 1)">ÏàòÎüâ ‚Üï</th>
                                    <th onclick="sortTable('quantityTable', 2)">Ï¥ù Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th onclick="sortTable('quantityTable', 3)">ÌèâÍ∑† Í∏∏Ïù¥ (m) ‚Üï</th>
                                    <th onclick="sortTable('quantityTable', 4)">Îã®Í∞Ä (Ïõê/m) ‚Üï</th>
                                    <th onclick="sortTable('quantityTable', 5)">Ï¥ù ÎπÑÏö© (Ïõê) ‚Üï</th>
                                    <th>ÎπÑÍ≥†</th>
                                </tr>
                            </thead>
                            <tbody id="quantityTableBody">
                                <!-- Î¨ºÎüâ Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ÏïåÎ¶º Î©îÏãúÏßÄ -->
    <div id="notification" class="notification"></div>

    <!-- ÌÖåÏä§Ìä∏ Í≤∞Í≥º ÌëúÏãú -->
    <div id="testResults" class="notification" style="top:80px;max-width:500px;height:auto;max-height:300px;overflow-y:auto;">
        <div id="testContent"></div>
    </div>

    <!-- JavaScript Íµ¨ÌòÑ -->
    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàòÎì§
        let cableData = [
  {
    "name": "P3101",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101A",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101B",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101C",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101D",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101E",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3101F",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 1 D.P.F"
  },
  {
    "name": "P3102",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102A",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102B",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102C",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102D",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102E",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3102F",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 17.0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "NO. 2 D.P.F"
  },
  {
    "name": "P3103",
    "type": "MC",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "D.P.F REMOTE PANEL"
  },
  {
    "name": "P3104",
    "type": "T1",
    "system": "POWER",
    "fromNode": "ER00",
    "toNode": "ER00",
    "length": 6.0,
    "outDia": 12.5,
    "fromRoom": "ER",
    "toRoom": "ER",
    "fromEquip": "NO.1/2 D.P.F SYSTEM",
    "toEquip": "AIR COMPRESSOR"
  },
  {
    "name": "P3006",
    "type": "DY2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER11",
    "length": 0,
    "outDia": 14.8,
    "fromRoom": "WH_FR40",
    "toRoom": "ER",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-6(ENGINE RM, WATER JET RM)"
  },
  {
    "name": "P3005",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "FW59",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "FWD",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-5(CREWS RM,CORRIDOR, STORE)"
  },
  {
    "name": "P3004",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP83",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "UPP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-4(ÌöåÏùòÏã§, MESS RM. CORRIDOR)"
  },
  {
    "name": "P3003",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV01",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-3(W/H,NAV.Ï°∞ÏÇ¨Ïã§,CAPT. RM)"
  },
  {
    "name": "P3002",
    "type": "DY2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP60",
    "length": 0,
    "outDia": 14.8,
    "fromRoom": "WH_FR40",
    "toRoom": "UPP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-2(UPPER DK. OUTSIDE)"
  },
  {
    "name": "P3001",
    "type": "DY2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV07",
    "length": 0,
    "outDia": 14.8,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "EM''CY LIGHT-1(BRIDGE DK. OUTSIDE)"
  },
  {
    "name": "P2914",
    "type": "D4",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER60",
    "length": 0,
    "outDia": 13.9,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "HUMPHREE CONTROL UNIT(RCU2) DC 24V SOURCE"
  },
  {
    "name": "P2913",
    "type": "D4",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER60",
    "length": 0,
    "outDia": 13.9,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 WATER JET P.I.M DC 24V SOURCE"
  },
  {
    "name": "P2912",
    "type": "D4",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER60",
    "length": 0,
    "outDia": 13.9,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 WATER JET P.I.M DC 24V SOURCE"
  },
  {
    "name": "P2911",
    "type": "D4",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER60",
    "length": 0,
    "outDia": 13.9,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 WATER JET P.I.M DC 24V SOURCE"
  },
  {
    "name": "P2910",
    "type": "D4",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER60",
    "length": 0,
    "outDia": 13.9,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 WATER JET P.I.M DC 24V SOURCE"
  },
  {
    "name": "P2909",
    "type": "D16",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER01A",
    "length": 0,
    "outDia": 19.4,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 MAIN ENGINE DC 24V SOURCE(60A)"
  },
  {
    "name": "P2908",
    "type": "D16",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER01A",
    "length": 0,
    "outDia": 19.4,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 MAIN ENGINE DC 24V SOURCE(60A)"
  },
  {
    "name": "P2907",
    "type": "D16",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER01A",
    "length": 0,
    "outDia": 19.4,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 MAIN ENGINE DC 24V SOURCE(60A)"
  },
  {
    "name": "P2906",
    "type": "D16",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER01A",
    "length": 0,
    "outDia": 19.4,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 MAIN ENGINE DC 24V SOURCE(60A)"
  },
  {
    "name": "P2905",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ERDB2",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "MAIN SWITCHBOARD DC 24V SOURCE"
  },
  {
    "name": "P2904A",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER05",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 G/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2904",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER05",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 G/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2903A",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER55",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 G/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2903",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER55",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 G/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2902A",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER06",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 M/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2902",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER06",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.2 M/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2901A",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "ERGP1",
    "toNode": "ER56",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "ER(S)",
    "toRoom": "ER(S)",
    "fromEquip": "MSBD (NO.1 AC 225V GEN. PANEL)",
    "toEquip": "NO.1 M/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2901",
    "type": "SY6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ER56",
    "length": 0,
    "outDia": 8.7,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NO.1 M/E STARTING BATTERY WITH C.O.S"
  },
  {
    "name": "P2811",
    "type": "D10",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP62B",
    "length": 0,
    "outDia": 17.1,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "ENDP(EM''CY NAU. INST. DIST. PANEL)"
  },
  {
    "name": "P2810",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP62B",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "NLP(NAV. SIGNAL LIGHT PANEL)"
  },
  {
    "name": "P2809",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP52",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "WH_FR40",
    "toRoom": "NAV(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "LIFE RAFT LIGHT(S)"
  },
  {
    "name": "P2808",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP02",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "WH_FR40",
    "toRoom": "NAV(P)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "LIFE RAFT LIGHT(P)"
  },
  {
    "name": "P2807",
    "type": "FD2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV34",
    "length": 0,
    "outDia": 14.1,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "F.A.S(FIRE DETEC. & ALARM SYS.)"
  },
  {
    "name": "P2806",
    "type": "D6",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "UP62B",
    "length": 0,
    "outDia": 15.2,
    "fromRoom": "WH_FR40",
    "toRoom": "WH",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "BCC(BRIDGE CONTROL CONSOLE)"
  },
  {
    "name": "P2805",
    "type": "SY70",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV33",
    "length": 0,
    "outDia": 17.9,
    "fromRoom": "WH_FR40",
    "toRoom": "COMP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "BATTERY FOR GENERAL(DC 24V 200AH)"
  },
  {
    "name": "P2804",
    "type": "SY70",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV33",
    "length": 0,
    "outDia": 17.9,
    "fromRoom": "WH_FR40",
    "toRoom": "COMP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "BATTERY FOR GENERAL(DC 24V 200AH)"
  },
  {
    "name": "P2803",
    "type": "SY70",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV33",
    "length": 0,
    "outDia": 17.9,
    "fromRoom": "WH_FR40",
    "toRoom": "COMP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "BATTERY FOR GENERAL(DC 24V 200AH)"
  },
  {
    "name": "P2802",
    "type": "SY70",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "NV33",
    "length": 0,
    "outDia": 17.9,
    "fromRoom": "WH_FR40",
    "toRoom": "COMP",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "BATTERY FOR GENERAL(DC 24V 200AH)"
  },
  {
    "name": "P2801",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62A",
    "toNode": "ERDB2",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "WH_FR40",
    "toRoom": "ER(S)",
    "fromEquip": "BATT. CH. & DISCH. BOARD",
    "toEquip": "MSBD(TCHARGE LIGHT)"
  },
  {
    "name": "P2702K",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "FWD",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.1P ST''BD AFT)"
  },
  {
    "name": "P2702J",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR46S",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2702I",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "FWD",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.1P ST''BD FWD)"
  },
  {
    "name": "P2702H",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR46S",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2702G",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW56",
    "toNode": "FW23",
    "length": 0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR35C",
    "toRoom": "FWD_FR46S",
    "fromEquip": "JB(NWT)",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2702F",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW56",
    "toNode": "FW06",
    "length": 0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR48C",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SMALL FAN(MAIN DK. CORRIDOR)"
  },
  {
    "name": "P2702E",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR48C",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SMALL FAN(MAIN DK. CORRIDOR)"
  },
  {
    "name": "P2702D",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "FWD_FR48C",
    "fromEquip": "SW(WT)",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2702C",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW55",
    "toNode": "FW55",
    "length": 8.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR35C",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2702B",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "FWD",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.2P)"
  },
  {
    "name": "P2702A",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW54",
    "toNode": "FW54",
    "length": 8.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR35C",
    "toRoom": "FWD",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2702",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "FW55",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "BCC",
    "toRoom": "FWD_FR35C",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2701F",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 13.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "CREW RM.1P PORT AFT",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.1P PORT AFT)"
  },
  {
    "name": "P2701E",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 13.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR40P",
    "toRoom": "REW RM.1P PORT MID",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2701D",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 13.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "REW RM.1P PORT MID",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.1P PORT MID)"
  },
  {
    "name": "P2701C",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 11.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR40P",
    "toRoom": "(CREW RM.1P PORT MID)",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)(CREW RM.1P PORT MID)"
  },
  {
    "name": "P2701B",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 7.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "(Í∞êÎèÖÍ¥ÄÏã§-1P)",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(CREW RM.1P PORT FWD)"
  },
  {
    "name": "P2701A",
    "type": "D1",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 7.0,
    "outDia": 11.7,
    "fromRoom": "FWD_FR40P",
    "toRoom": "(Í∞êÎèÖÍ¥ÄÏã§-1P)",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)(CREW RM.1P PORT FWD)"
  },
  {
    "name": "P2701",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP01A",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "BCC",
    "toRoom": "FWD_FR40P",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2603D",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP71",
    "toNode": "UP72",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "nan",
    "toRoom": "WH",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(TOILET B)"
  },
  {
    "name": "P2603C",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP33",
    "toNode": "UP52",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "UPP_FR30P",
    "toRoom": "WH",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2603B",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP00",
    "toNode": "UP00",
    "length": 7.0,
    "outDia": 13.7,
    "fromRoom": "nan",
    "toRoom": "WH",
    "fromEquip": "SW(WT)",
    "toEquip": "SMALL FAN(TOILET A)"
  },
  {
    "name": "P2603A",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP02",
    "toNode": "UP33",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "UPP_FR30P",
    "toRoom": "WH",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(WT)"
  },
  {
    "name": "P2603",
    "type": "DY2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP02",
    "length": 0,
    "outDia": 14.8,
    "fromRoom": "BCC",
    "toRoom": "UPP_FR30P",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2602F",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP55",
    "toNode": "UP52",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "nan",
    "toRoom": "UPP DK. CORIDOR",
    "fromEquip": "SW(NWT)",
    "toEquip": "SMALL FAN(UPP DK. CORIDOR)"
  },
  {
    "name": "P2602E",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP01",
    "toNode": "UP55",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "UPP_FR42P",
    "toRoom": "MESS RM",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(NWT)"
  },
  {
    "name": "P2602D",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP01",
    "toNode": "UP02",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "nan",
    "toRoom": "MESS RM",
    "fromEquip": "SW(NWT)",
    "toEquip": "SMALL FAN(MESS.RM)"
  },
  {
    "name": "P2602C",
    "type": "DY1",
    "system": "POWER",
    "fromNode": "UP01",
    "toNode": "UP05",
    "length": 0,
    "outDia": 13.7,
    "fromRoom": "UPP_FR42P",
    "toRoom": "MEET''G RM",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(NWT)"
  },
  {
    "name": "P2602B",
    "type": "D1",
    "system": "POWER",
    "fromNode": "UP23A",
    "toNode": "UP07",
    "length": 0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "MEET''G RM",
    "fromEquip": "SW(NWT)",
    "toEquip": "SMALL FAN(CONF.RM)"
  },
  {
    "name": "P2602A",
    "type": "D1",
    "system": "POWER",
    "fromNode": "UP00",
    "toNode": "UP00",
    "length": 7.0,
    "outDia": 11.7,
    "fromRoom": "UPP_FR42P",
    "toRoom": "WH",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(NWT)"
  },
  {
    "name": "P2602",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP01",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "BCC",
    "toRoom": "UPP_FR42P",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2601D",
    "type": "D1",
    "system": "POWER",
    "fromNode": "NV33",
    "toNode": "NV51",
    "length": 0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "WH",
    "fromEquip": "SW(NWT)",
    "toEquip": "SMALL FAN(INSPEC. RM&CAP RM)"
  },
  {
    "name": "P2601C",
    "type": "D1",
    "system": "POWER",
    "fromNode": "UP00",
    "toNode": "UP00",
    "length": 5.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "WH",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(NWT)"
  },
  {
    "name": "P2601B",
    "type": "D1",
    "system": "POWER",
    "fromNode": "NV00",
    "toNode": "NV00",
    "length": 7.0,
    "outDia": 11.7,
    "fromRoom": "nan",
    "toRoom": "WH",
    "fromEquip": "SW(NWT)",
    "toEquip": "SMALL FAN(WHEEL HOUSE)"
  },
  {
    "name": "P2601A",
    "type": "D1",
    "system": "POWER",
    "fromNode": "NV01",
    "toNode": "NV05",
    "length": 0,
    "outDia": 11.7,
    "fromRoom": "NAV_FR36P",
    "toRoom": "WH",
    "fromEquip": "JB(NWT)",
    "toEquip": "SW(NWT)"
  },
  {
    "name": "P2601",
    "type": "D2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "NV04",
    "length": 0,
    "outDia": 12.8,
    "fromRoom": "BCC",
    "toRoom": "NAV_FR36P",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "JB(NWT)"
  },
  {
    "name": "P2502F",
    "type": "MC",
    "system": "POWER",
    "fromNode": "FW54",
    "toNode": "FW56",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "FWD_FR41S",
    "toRoom": "FWD_FR45S",
    "fromEquip": "WALL TYPE A/C & HEATER(CREW RM.1P ST''BD AFT,)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.1P ST''BD FWD,)"
  },
  {
    "name": "P2502E",
    "type": "MC",
    "system": "POWER",
    "fromNode": "FW52",
    "toNode": "FW54",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "FWD_FR31S",
    "toRoom": "FWD_FR41S",
    "fromEquip": "WALL TYPE A/C & HEATER(CREW RM.2P,)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.1P ST''BD AFT,)"
  },
  {
    "name": "P2502D",
    "type": "MC",
    "system": "POWER",
    "fromNode": "FW00",
    "toNode": "FW00",
    "length": 9.0,
    "outDia": 15.0,
    "fromRoom": "FWD_FR31P",
    "toRoom": "FWD_FR31S",
    "fromEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT AFT,)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.2P,)"
  },
  {
    "name": "P2502C",
    "type": "MC",
    "system": "POWER",
    "fromNode": "FW03",
    "toNode": "FW02",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "FWD_FR38P",
    "toRoom": "FWD_FR31P",
    "fromEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT MID.)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT AFT,)"
  },
  {
    "name": "P2502B",
    "type": "MC",
    "system": "POWER",
    "fromNode": "FW03",
    "toNode": "FW03",
    "length": 9.0,
    "outDia": 15.0,
    "fromRoom": "FWD_FR43S",
    "toRoom": "FWD_FR38P",
    "fromEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT FWD,)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT MID.)"
  },
  {
    "name": "P2502A",
    "type": "MC",
    "system": "POWER",
    "fromNode": "UP31B",
    "toNode": "FW04",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "NAV_FR31",
    "toRoom": "FWD_FR43P",
    "fromEquip": "NO.2 A/C OUTSIDE UNIT(BRIDGE DECK PORT)",
    "toEquip": "WALL TYPE A/C & HEATER(CREW RM.1P PORT FWD,)"
  },
  {
    "name": "P2502",
    "type": "TY6",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP31B",
    "length": 0,
    "outDia": 18.3,
    "fromRoom": "BCC",
    "toRoom": "NAV_FR31",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "NO.2 A/C OUTSIDE UNIT(BRIDGE DECK PORT)"
  },
  {
    "name": "P2501D",
    "type": "MC",
    "system": "POWER",
    "fromNode": "UP83",
    "toNode": "UP22A",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "CONF RM",
    "toRoom": "MESS RM",
    "fromEquip": "CEILING TYPE A/C & HEATER(CONF. RM.)",
    "toEquip": "WALL TYPE A/C & HEATER(MESS RM.)"
  },
  {
    "name": "P2501C",
    "type": "MC",
    "system": "POWER",
    "fromNode": "NV52A",
    "toNode": "UP83",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "INSPEC RM",
    "toRoom": "CONF RM",
    "fromEquip": "WALL TYPE A/C & HEATER(INSPEC. RM. & CAPT. RM.)",
    "toEquip": "CEILING TYPE A/C & HEATER(CONF. RM.)"
  },
  {
    "name": "P2501B",
    "type": "MC",
    "system": "POWER",
    "fromNode": "NV34",
    "toNode": "NV52A",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "WH_FR42",
    "toRoom": "INSPEC RM",
    "fromEquip": "CEILING TYPE A/C & HEATER(WHEEL HOUSE)",
    "toEquip": "WALL TYPE A/C & HEATER(INSPEC. RM. & CAPT. RM.)"
  },
  {
    "name": "P2501A",
    "type": "MC",
    "system": "POWER",
    "fromNode": "UP31B",
    "toNode": "NV34",
    "length": 0,
    "outDia": 15.0,
    "fromRoom": "NAV_FR31",
    "toRoom": "WH",
    "fromEquip": "NO.1 A/C OUTSIDE UNIT(BRIDGE DECK PORT)",
    "toEquip": "CEILING TYPE A/C & HEATER(WHEEL HOUSE)"
  },
  {
    "name": "P2501",
    "type": "TY6",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP31B",
    "length": 0,
    "outDia": 18.3,
    "fromRoom": "BCC",
    "toRoom": "P2502",
    "fromEquip": "POWER DIST. PANEL-2",
    "toEquip": "NO.1 A/C OUTSIDE UNIT(BRIDGE DECK PORT)"
  },
  {
    "name": "P2404",
    "type": "TY2",
    "system": "POWER",
    "fromNode": "UP62B",
    "toNode": "UP73",
    "length": 0,
    "outDia": 15.5,
    "fromRoom": "BCC",
    "toRoom": "WH",
    "fromEquip": "POWER DIST. PANEL-1",
    "toEquip": "ELEC. WATER HEATER(Ï†ÑÏû•Ïãù30L)(TOILET B, 11.4A)"
  }
];
        let nodeData = [
  {
    "name": "ER00",
    "relation": "",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER01",
    "relation": "ER51,ER70,ER02,ER01A",
    "linkLength": 0.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER01A",
    "relation": "ER01,ER02,ER01B",
    "linkLength": 4.3,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER01B",
    "relation": "ER01A",
    "linkLength": 2.9,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER02",
    "relation": "ER01,ER01A,ER03,ER03A",
    "linkLength": 0.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER03",
    "relation": "ER03A,ER02,ER04,ER10",
    "linkLength": 1.2,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER03A",
    "relation": "ER03,ER02",
    "linkLength": 1.2,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER04",
    "relation": "ER03,ER10,ER04A",
    "linkLength": 0.7,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER04A",
    "relation": "ER05,ER04",
    "linkLength": 1.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER05",
    "relation": "ER06,ER04A",
    "linkLength": 3.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER06",
    "relation": "ER07,ER05",
    "linkLength": 2.3,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER07",
    "relation": "ER08,ER11,ER06",
    "linkLength": 3.9,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER08",
    "relation": "ER09,ER07,ER11",
    "linkLength": 1.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER09",
    "relation": "ER08,ER12,ER14",
    "linkLength": 2.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER10",
    "relation": "ER03,ER04,FW01",
    "linkLength": 1.6,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER11",
    "relation": "ER08,ER07,ER60,ER12",
    "linkLength": 2.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER12",
    "relation": "ER11,ER60,ER09,ER14",
    "linkLength": 1.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER14",
    "relation": "ER09,ER12",
    "linkLength": 2.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER51",
    "relation": "ER52,ERGP2,ER70,ER01",
    "linkLength": 0.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER52",
    "relation": "ER51,ERGP2,ER53,ERGP1",
    "linkLength": 0.7,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER53",
    "relation": "ER52,ERGP1,ERDB2,ER53A",
    "linkLength": 0.7,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER53A",
    "relation": "ER54,ER53B,ERDB2,ER53",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER53B",
    "relation": "ER54,ER53A",
    "linkLength": 1.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER54",
    "relation": "ER55,ER53A,ER53B",
    "linkLength": 2.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER55",
    "relation": "ER56,ER54",
    "linkLength": 2.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER56",
    "relation": "ER57,ER55",
    "linkLength": 2.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER57",
    "relation": "ER58,ER60,ER56",
    "linkLength": 3.6,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER58",
    "relation": "ER59,ER57,ER60",
    "linkLength": 0.6,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER59",
    "relation": "ER58",
    "linkLength": 0.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER60",
    "relation": "ER58,ER57,ER11,ER12",
    "linkLength": 2.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ER70",
    "relation": "ER51,ER01,FW51",
    "linkLength": 1.6,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ERDB2",
    "relation": "ER53,ER53A",
    "linkLength": 1.2,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ERGP1",
    "relation": "ER52,ER53",
    "linkLength": 1.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "ERGP2",
    "relation": "ER51,ER52",
    "linkLength": 1.3,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW00",
    "relation": "",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW01",
    "relation": "FW02,FW31,ER10",
    "linkLength": 0.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW02",
    "relation": "FW03,FW21,FW01,FW31",
    "linkLength": 1.8,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW03",
    "relation": "FW02,FW21,FW22,FW04,UP01A",
    "linkLength": 3.3,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW04",
    "relation": "FW22,FW03,UP01A,FW05,FW23",
    "linkLength": 2.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW05",
    "relation": "FW04,FW23,FW06",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW057",
    "relation": "FW56,FW61,FW58",
    "linkLength": 2.6,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW06",
    "relation": "FW05,FW07",
    "linkLength": 1.7,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW07",
    "relation": "FW06,FW08",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW08",
    "relation": "FW07,FW59,FW58",
    "linkLength": 1.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW21",
    "relation": "FW53,FW03,FW02",
    "linkLength": 2.4,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW22",
    "relation": "FW55,FW04,FW03,UP01A",
    "linkLength": 2.2,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW23",
    "relation": "FW04,FW05,FW61",
    "linkLength": 2.2,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW31",
    "relation": "FW02,FW01",
    "linkLength": 0.5,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW51",
    "relation": "FW52,FW71,ER70",
    "linkLength": 0.1,
    "connectedCables": 0,
    "totalCrossSection": 0
  },
  {
    "name": "FW52",
    "relation": "FW53,FW54,FW51,FW71",
    "linkLength": 1.9,
    "connectedCables": 0,
    "totalCrossSection": 0
  }
];
        let filteredCableData = [...cableData];
        let charts = {};
        let scene, camera, renderer, controls;
        let nodeObjects = [];
        let cableObjects = [];
        let testResults = [];

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üö¢ SEASTAR Ultimate Cable Management System ÏãúÏûë');
            initializeSystem();
            loadSampleData();
        });

        // ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî
        function initializeSystem() {
            console.log('ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî Ï§ë...');
            calculateNodeConnections();
            updateAllData();
            showNotification('SEASTAR ÏãúÏä§ÌÖúÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§!', 'success');
        }

        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadSampleData() {
            console.log('Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ï§ë...');
            calculateNodeConnections();
            updateAllData();
            showNotification('ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Í∞Ä Î°úÎìúÎêòÏóàÏäµÎãàÎã§.', 'info');
        }

        // Ïã§Ï†ú ÌååÏùºÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        function loadFiles() {
            const cableFile = document.getElementById('cableFile').files[0];
            const nodeFile = document.getElementById('nodeFile').files[0];

            if (cableFile) {
                loadExcelFile(cableFile, 'cable');
            }
            if (nodeFile) {
                loadExcelFile(nodeFile, 'node');
            }

            if (!cableFile && !nodeFile) {
                showNotification('ÌååÏùºÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.', 'warning');
            }
        }

        // Excel ÌååÏùº Î°úÎìú Ìï®Ïàò
        function loadExcelFile(file, type) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1, blankrows: false });

                    if (type === 'cable') {
                        processCableData(jsonData);
                    } else if (type === 'node') {
                        processNodeData(jsonData);
                    }

                    updateAllData();
                    showNotification(`${type} ÌååÏùºÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î°úÎìúÎêòÏóàÏäµÎãàÎã§.`, 'success');
                } catch (error) {
                    showNotification(`ÌååÏùº Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ${error.message}`, 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // ÏºÄÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
        function getColumnIndex(header, possibleNames) {
            for (const name of possibleNames) {
                const index = header.indexOf(name);
                if (index !== -1) {
                    return index;
                }
            }
            return -1;
        }

        // ÏºÄÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
        function processCableData(rawData) {
            if (rawData.length < 2) return; // No data or only header
            const header = rawData[0].map(h => String(h).toLowerCase());
            
            const columnMapping = {
                name: ['cable_name', 'name'],
                type: ['cable_type', 'type'],
                system: ['cable_system', 'system'],
                fromNode: ['from_node', 'fromnode'],
                toNode: ['to_node', 'tonode'],
                length: ['por_length', 'length'],
                outDia: ['cable_outdia', 'outdia'],
                fromRoom: ['from_room', 'fromroom'],
                toRoom: ['to_room', 'toroom'],
                fromEquip: ['from_equip', 'fromequip'],
                toEquip: ['to_equip', 'toequip'],
                weight: ['cable_weight', 'weight'],
                path: ['cable_path', 'path']
            };

            const indices = {};
            for (const key in columnMapping) {
                indices[key] = getColumnIndex(header, columnMapping[key]);
            }

            cableData = rawData.slice(1).map(row => ({
                name: String(row[indices.name] || ''),
                type: String(row[indices.type] || ''),
                system: String(row[indices.system] || ''),
                fromNode: String(row[indices.fromNode] || ''),
                toNode: String(row[indices.toNode] || ''),
                length: parseFloat(row[indices.length] || 0),
                outDia: parseFloat(row[indices.outDia] || 0),
                fromRoom: String(row[indices.fromRoom] || ''),
                toRoom: String(row[indices.toRoom] || ''),
                fromEquip: String(row[indices.fromEquip] || ''),
                toEquip: String(row[indices.toEquip] || ''),
                weight: parseFloat(row[indices.weight] || 0),
                path: String(row[indices.path] || '')
            }));
            filteredCableData = [...cableData];
        }

        // ÎÖ∏Îìú Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
        function processNodeData(rawData) {
            if (rawData.length < 2) return; // No data or only header
            const header = rawData[0].map(h => String(h).toLowerCase());

            const columnMapping = {
                name: ['node_rname', 'name'],
                relation: ['relation'],
                linkLength: ['link_length', 'linklength']
            };

            const indices = {};
            for (const key in columnMapping) {
                indices[key] = getColumnIndex(header, columnMapping[key]);
            }

            nodeData = rawData.slice(1).map(row => ({
                name: String(row[indices.name] || ''),
                relation: String(row[indices.relation] || ''),
                linkLength: parseFloat(row[indices.linkLength] || 0),
                connectedCables: 0,
                totalCrossSection: 0
            }));

            calculateNodeConnections();
        }

        // ÎÖ∏Îìú Ïó∞Í≤∞ Í≥ÑÏÇ∞
        function calculateNodeConnections() {
            const nodeConnections = {};

            cableData.forEach(cable => {
                if (cable.fromNode && cable.fromNode !== '') {
                    nodeConnections[cable.fromNode] = (nodeConnections[cable.fromNode] || 0) + 1;
                }
                if (cable.toNode && cable.toNode !== '' && cable.toNode !== cable.fromNode) {
                    nodeConnections[cable.toNode] = (nodeConnections[cable.toNode] || 0) + 1;
                }
            });

            nodeData.forEach(node => {
                node.connectedCables = nodeConnections[node.name] || 0;
                node.totalCrossSection = calculateNodeCrossSection(node.name);
            });
        }

        // ÎÖ∏ÎìúÎ≥Ñ Îã®Î©¥Ï†Å Í≥ÑÏÇ∞ (ÏïÑÏõÉ Îã§Ïù¥Ïñ¥ Í∏∞Î∞ò)
        function calculateNodeCrossSection(nodeName) {
            let totalCrossSection = 0;

            cableData.forEach(cable => {
                if ((cable.fromNode === nodeName || cable.toNode === nodeName) && cable.outDia > 0) {
                    // ÏõêÌòï Îã®Î©¥Ï†Å Í≥ÑÏÇ∞: œÄ * (d/2)¬≤
                    const radius = cable.outDia / 2;
                    const crossSection = Math.PI * radius * radius;
                    totalCrossSection += crossSection;
                }
            });

            return Math.round(totalCrossSection * 100) / 100;
        }

        // Î™®Îì† Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateAllData() {
            updateStats();
            updateFilters();
            updateTables();
            updateCharts();
            populateSelects();
        }

        // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateStats() {
            const totalCables = cableData.length;
            const totalNodes = nodeData.length;
            const cableTypes = new Set(cableData.map(c => c.type).filter(t => t)).size;
            const totalLength = cableData.reduce((sum, c) => sum + (c.length || 0), 0);

            // ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜµÍ≥Ñ
            document.getElementById('totalCables').textContent = totalCables.toLocaleString();
            document.getElementById('totalNodes').textContent = totalNodes.toLocaleString();
            document.getElementById('cableTypes').textContent = cableTypes.toLocaleString();
            document.getElementById('totalLength').textContent = totalLength.toFixed(1);

            // ÎåÄÏãúÎ≥¥Îìú ÌÜµÍ≥Ñ
            document.getElementById('dashTotalCables').textContent = totalCables.toLocaleString();
            document.getElementById('dashTotalNodes').textContent = totalNodes.toLocaleString();
            document.getElementById('dashCableTypes').textContent = cableTypes.toLocaleString();
            document.getElementById('dashTotalLength').textContent = totalLength.toFixed(1);
        }

        // ÎÇòÎ®∏ÏßÄ Î™®Îì† JavaScript Ìï®ÏàòÎì§ (Í∏∞Ï°¥ Íµ¨ÌòÑÏùò ÏôÑÏ†ÑÌïú Î≤ÑÏ†Ñ)

        // ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateFilters() {
            const systemFilter = document.getElementById('systemFilter');
            const typeFilter = document.getElementById('typeFilter');
            const typeAnalysisFilter = document.getElementById('typeAnalysisFilter');

            const systems = [...new Set(cableData.map(c => c.system).filter(s => s))].sort();
            systemFilter.innerHTML = '<option value="">Î™®Îì† ÏãúÏä§ÌÖú</option>';
            systems.forEach(system => {
                const option = document.createElement('option');
                option.value = system;
                option.textContent = system;
                systemFilter.appendChild(option);
            });

            const types = [...new Set(cableData.map(c => c.type).filter(t => t))].sort();
            typeFilter.innerHTML = '<option value="">Î™®Îì† ÌÉÄÏûÖ</option>';
            typeAnalysisFilter.innerHTML = '<option value="all">Î™®Îì† ÌÉÄÏûÖ</option>';

            types.forEach(type => {
                const option1 = document.createElement('option');
                option1.value = type;
                option1.textContent = type;
                typeFilter.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = type;
                option2.textContent = type;
                typeAnalysisFilter.appendChild(option2);
            });
        }

        // ÏÖÄÎ†âÌä∏ Î∞ïÏä§ Ï±ÑÏö∞Í∏∞
        function populateSelects() {
            const cableSelect = document.getElementById('cableSelect');
            cableSelect.innerHTML = '<option value="">ÏºÄÏù¥Î∏î ÏÑ†ÌÉù</option>';

            cableData.forEach((cable, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${cable.name} (${cable.type})`;
                cableSelect.appendChild(option);
            });
        }

        // ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateTables() {
            updateCableTable();
            updateNodeTable();
            updateTypeTable();
            updateRouteTable();
            updateQuantityTable();
        }

        // ÏºÄÏù¥Î∏î ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateCableTable() {
            const tbody = document.getElementById('cableTableBody');
            tbody.innerHTML = '';

            filteredCableData.forEach((cable, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${cable.name || ''}</td>
                    <td>${cable.type || ''}</td>
                    <td>${cable.system || ''}</td>
                    <td>${cable.fromNode || ''}</td>
                    <td>${cable.toNode || ''}</td>
                    <td>${(cable.length || 0).toFixed(1)}</td>
                    <td>${(cable.outDia || 0).toFixed(1)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="editCable(${index})" style="margin:2px;padding:5px 10px;font-size:12px;">Ìé∏Ïßë</button>
                        <button class="btn btn-secondary" onclick="viewCableDetail(${index})" style="margin:2px;padding:5px 10px;font-size:12px;">ÏÉÅÏÑ∏</button>
                    </td>
                `;
            });
        }

        // ÎÖ∏Îìú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateNodeTable() {
            const tbody = document.getElementById('nodeTableBody');
            tbody.innerHTML = '';

            nodeData.forEach((node, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${node.name || ''}</td>
                    <td>${node.connectedCables}</td>
                    <td>${node.totalCrossSection.toFixed(2)}</td>
                    <td>${node.relation || '-'}</td>
                    <td>${(node.linkLength || 0).toFixed(1)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="viewNodeDetail(${index})" style="margin:2px;padding:5px 10px;font-size:12px;">ÏÉÅÏÑ∏</button>
                    </td>
                `;
            });
        }

        // ÌÉÄÏûÖ ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
        function calculateTypeStats() {
            const typeStats = {};

            cableData.forEach(cable => {
                const type = cable.type || 'Unknown';
                if (!typeStats[type]) {
                    typeStats[type] = {
                        count: 0,
                        totalLength: 0,
                        totalOutDia: 0,
                        cables: [],
                        skinRange: ''
                    };
                }

                typeStats[type].count++;
                typeStats[type].totalLength += cable.length || 0;
                typeStats[type].totalOutDia += cable.outDia || 0;
                typeStats[type].cables.push(cable);
            });

            Object.keys(typeStats).forEach(type => {
                const stats = typeStats[type];
                stats.avgLength = stats.totalLength / stats.count;
                stats.avgOutDia = stats.totalOutDia / stats.count;

                // Ïä§ÌÇ® Î≤àÌò∏ Î≤îÏúÑ Í≥ÑÏÇ∞
                const skinNumbers = stats.cables
                    .map(c => c.name.match(/\d+/))
                    .filter(match => match)
                    .map(match => parseInt(match[0]))
                    .sort((a, b) => a - b);

                if (skinNumbers.length > 0) {
                    stats.skinRange = `${skinNumbers[0]} ~ ${skinNumbers[skinNumbers.length - 1]}`;
                } else {
                    stats.skinRange = '-';
                }
            });

            return typeStats;
        }

        // ÌÉÄÏûÖÎ≥Ñ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateTypeTable() {
            const tbody = document.getElementById('typeTableBody');
            tbody.innerHTML = '';

            const typeStats = calculateTypeStats();

            Object.entries(typeStats).forEach(([type, stats]) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${type}</td>
                    <td>${stats.count}</td>
                    <td>${stats.skinRange}</td>
                    <td>${stats.avgLength.toFixed(1)}</td>
                    <td>${stats.totalLength.toFixed(1)}</td>
                    <td>${stats.avgOutDia.toFixed(1)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="viewTypeDetail('${type}')" style="margin:2px;padding:5px 10px;font-size:12px;">ÏÉÅÏÑ∏</button>
                    </td>
                `;
            });
        }

        // Í≤ΩÎ°ú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateRouteTable() {
            const tbody = document.getElementById('routeTableBody');
            tbody.innerHTML = '';

            cableData.forEach((cable, index) => {
                const row = tbody.insertRow();
                const routePath = `${cable.fromNode} ‚Üí ${cable.toNode}`;
                const viaNodes = cable.path || '-';

                row.innerHTML = `
                    <td>${cable.name}</td>
                    <td>${routePath}</td>
                    <td>${(cable.length || 0).toFixed(1)}</td>
                    <td>${viaNodes}</td>
                    <td><span class="badge badge-success">Ï†ïÏÉÅ</span></td>
                    <td>
                        <button class="btn btn-secondary" onclick="editRoute(${index})" style="margin:2px;padding:5px 10px;font-size:12px;">Ìé∏Ïßë</button>
                    </td>
                `;
            });
        }

        // Î¨ºÎüâ ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
        function calculateQuantityStats() {
            const quantityStats = {};

            cableData.forEach(cable => {
                const type = cable.type || 'Unknown';
                if (!quantityStats[type]) {
                    quantityStats[type] = {
                        count: 0,
                        totalLength: 0
                    };
                }

                quantityStats[type].count++;
                quantityStats[type].totalLength += cable.length || 0;
            });

            Object.keys(quantityStats).forEach(type => {
                const stats = quantityStats[type];
                stats.avgLength = stats.totalLength / stats.count;
            });

            return quantityStats;
        }

        // ÏºÄÏù¥Î∏î Îã®Í∞Ä Í∞ÄÏ†∏Ïò§Í∏∞
        function getCableUnitPrice(type) {
            const priceMap = {
                'MC': 15000, 'D2': 12000, 'T2': 8000, 'TY2': 10000, 'CAT6': 5000,
                'D1': 9000, 'FD1': 7000, 'DY2': 11000, 'TTS1': 6000, 'M2': 13000
            };
            return priceMap[type] || 10000;
        }

        // ÏºÄÏù¥Î∏î Î¨¥Í≤å Í≥ÑÏÇ∞
        function getCableWeight(type) {
            const weightMap = {
                'MC': 2.5, 'D2': 1.8, 'T2': 1.2, 'TY2': 1.5, 'CAT6': 0.8,
                'D1': 1.0, 'FD1': 0.9, 'DY2': 1.6, 'TTS1': 0.7, 'M2': 2.0
            };
            return weightMap[type] || 1.5;
        }

        // Î¨ºÎüâ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateQuantityTable() {
            const tbody = document.getElementById('quantityTableBody');
            tbody.innerHTML = '';

            const quantityStats = calculateQuantityStats();

            Object.entries(quantityStats).forEach(([type, stats]) => {
                const unitPrice = getCableUnitPrice(type);
                const totalCost = stats.totalLength * unitPrice;

                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${type}</td>
                    <td>${stats.count}</td>
                    <td>${stats.totalLength.toFixed(1)}</td>
                    <td>${stats.avgLength.toFixed(1)}</td>
                    <td>${unitPrice.toLocaleString()}</td>
                    <td>${totalCost.toLocaleString()}</td>
                    <td>ÌëúÏ§Ä Í∑úÍ≤©</td>
                `;
            });
        }

        // Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ (ÏôÑÏ†Ñ Íµ¨ÌòÑ)
        function updateCharts() {
            updateSystemChart();
            updateTypeChart();
            updateNodeChart();
            updateTypeAnalysisChart();
            updateQuantityChart();
        }

        function updateSystemChart() {
            const ctx = document.getElementById('systemChart')?.getContext('2d');
            if (!ctx) return;

            if (charts.systemChart) charts.systemChart.destroy();

            const systemCounts = {};
            cableData.forEach(cable => {
                const system = cable.system || 'Unknown';
                systemCounts[system] = (systemCounts[system] || 0) + 1;
            });

            charts.systemChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(systemCounts),
                    datasets: [{
                        data: Object.values(systemCounts),
                        backgroundColor: ['#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6'],
                        borderWidth: 2,
                        borderColor: '#1e293b'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom', labels: { color: '#e2e8f0' } }
                    }
                }
            });
        }

        function updateTypeChart() {
            const ctx = document.getElementById('typeChart')?.getContext('2d');
            if (!ctx) return;

            if (charts.typeChart) charts.typeChart.destroy();

            const typeCounts = {};
            cableData.forEach(cable => {
                const type = cable.type || 'Unknown';
                typeCounts[type] = (typeCounts[type] || 0) + 1;
            });

            charts.typeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(typeCounts),
                    datasets: [{
                        label: 'ÏºÄÏù¥Î∏î Ïàò',
                        data: Object.values(typeCounts),
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#e2e8f0' } },
                        x: { ticks: { color: '#e2e8f0' } }
                    },
                    plugins: { legend: { labels: { color: '#e2e8f0' } } }
                }
            });
        }

        function updateNodeChart() {
            const ctx = document.getElementById('nodeChart')?.getContext('2d');
            if (!ctx) return;

            if (charts.nodeChart) charts.nodeChart.destroy();

            const topNodes = nodeData
                .sort((a, b) => b.connectedCables - a.connectedCables)
                .slice(0, 10);

            charts.nodeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topNodes.map(n => n.name),
                    datasets: [{
                        label: 'Ïó∞Í≤∞Îêú ÏºÄÏù¥Î∏î Ïàò',
                        data: topNodes.map(n => n.connectedCables),
                        backgroundColor: '#10b981'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    scales: {
                        x: { beginAtZero: true, ticks: { color: '#e2e8f0' } },
                        y: { ticks: { color: '#e2e8f0' } }
                    },
                    plugins: { legend: { labels: { color: '#e2e8f0' } } }
                }
            });
        }

        function updateTypeAnalysisChart() {
            const ctx = document.getElementById('typeAnalysisChart')?.getContext('2d');
            if (!ctx) return;

            if (charts.typeAnalysisChart) charts.typeAnalysisChart.destroy();

            const typeStats = calculateTypeStats();
            const types = Object.keys(typeStats);

            charts.typeAnalysisChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: types,
                    datasets: [{
                        label: 'ÏàòÎüâ',
                        data: types.map(type => typeStats[type].count),
                        backgroundColor: '#3b82f6'
                    }, {
                        label: 'Ï¥ù Í∏∏Ïù¥ (m)',
                        data: types.map(type => typeStats[type].totalLength),
                        backgroundColor: '#ef4444',
                        type: 'line'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#e2e8f0' } },
                        x: { ticks: { color: '#e2e8f0' } }
                    },
                    plugins: { legend: { labels: { color: '#e2e8f0' } } }
                }
            });
        }

        function updateQuantityChart() {
            const ctx = document.getElementById('quantityChart')?.getContext('2d');
            if (!ctx) return;

            if (charts.quantityChart) charts.quantityChart.destroy();

            const quantityStats = calculateQuantityStats();

            charts.quantityChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(quantityStats),
                    datasets: [{
                        data: Object.values(quantityStats).map(s => s.totalLength),
                        backgroundColor: ['#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#06b6d4']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom', labels: { color: '#e2e8f0' } } }
                }
            });
        }

        // Í≤ÄÏÉâ Î∞è ÌïÑÌÑ∞ Ìï®ÏàòÎì§
        function searchCables() {
            const searchTerm = document.getElementById('cableSearch').value.toLowerCase();
            filteredCableData = cableData.filter(cable => 
                cable.name.toLowerCase().includes(searchTerm) ||
                cable.type.toLowerCase().includes(searchTerm) ||
                cable.system.toLowerCase().includes(searchTerm)
            );
            updateCableTable();
        }

        function filterCables() {
            const systemFilter = document.getElementById('systemFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;

            filteredCableData = cableData.filter(cable => {
                const systemMatch = !systemFilter || cable.system === systemFilter;
                const typeMatch = !typeFilter || cable.type === typeFilter;
                return systemMatch && typeMatch;
            });
            updateCableTable();
        }

        function searchNodes() {
            const searchTerm = document.getElementById('nodeSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#nodeTableBody tr');
            rows.forEach(row => {
                const nodeNameCell = row.cells[0];
                if (nodeNameCell) {
                    const nodeName = nodeNameCell.textContent.toLowerCase();
                    row.style.display = nodeName.includes(searchTerm) ? '' : 'none';
                }
            });
        }

        function quickSearch() {
            const searchTerm = document.getElementById('quickSearch').value.toLowerCase();
            const resultsDiv = document.getElementById('quickSearchResults');

            if (searchTerm.length < 2) {
                resultsDiv.innerHTML = '';
                return;
            }

            const cableResults = cableData.filter(c => 
                c.name.toLowerCase().includes(searchTerm) ||
                c.type.toLowerCase().includes(searchTerm)
            ).slice(0, 5);

            const nodeResults = nodeData.filter(n => 
                n.name.toLowerCase().includes(searchTerm)
            ).slice(0, 5);

            let html = '';
            if (cableResults.length > 0) {
                html += '<div style="font-weight:bold;color:#60a5fa;margin-bottom:5px;">ÏºÄÏù¥Î∏î:</div>';
                cableResults.forEach(c => {
                    html += `<div style="padding:2px 0;cursor:pointer;font-size:12px;" onclick="showTab('cables');searchCables();document.getElementById('cableSearch').value='${c.name}'">${c.name} (${c.type})</div>`;
                });
            }
            if (nodeResults.length > 0) {
                html += '<div style="font-weight:bold;color:#10b981;margin:10px 0 5px;">ÎÖ∏Îìú:</div>';
                nodeResults.forEach(n => {
                    html += `<div style="padding:2px 0;cursor:pointer;font-size:12px;" onclick="showTab('nodes')">${n.name}</div>`;
                });
            }

            resultsDiv.innerHTML = html || '<div style="color:#6b7280;font-size:12px;">Í≤∞Í≥º ÏóÜÏùå</div>';
        }

        // ÌÖåÏù¥Î∏î Ï†ïÎ†¨ Ìï®Ïàò
        function sortTable(tableId, columnIndex) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            const isAscending = table.dataset.sortDirection !== 'asc';
            table.dataset.sortDirection = isAscending ? 'asc' : 'desc';

            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim();
                const bValue = b.cells[columnIndex].textContent.trim();

                const aNum = parseFloat(aValue.replace(/[^0-9.-]/g, ''));
                const bNum = parseFloat(bValue.replace(/[^0-9.-]/g, ''));

                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return isAscending ? aNum - bNum : bNum - aNum;
                }

                return isAscending ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
            });

            rows.forEach(row => tbody.appendChild(row));
        }

        // ÌÉ≠ Ï†ÑÌôò
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));

            const selectedTab = document.getElementById(tabName);
            if (selectedTab) selectedTab.classList.remove('hidden');

            const selectedButton = document.querySelector(`[onclick="showTab('${tabName}')"]`);
            if (selectedButton) selectedButton.classList.add('active');

            if (tabName === '3d' && !renderer) {
                setTimeout(() => initialize3D(), 100);
            }
        }

        // 3D ÏãúÍ∞ÅÌôî (Í∏∞Î≥∏ Íµ¨ÌòÑ)
        function initialize3D() {
            const container = document.getElementById('threejsContainer');
            if (!container || typeof THREE === 'undefined') {
                showNotification('Three.js ÎùºÏù¥Î∏åÎü¨Î¶¨Î•º Î°úÎìúÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                return;
            }

            try {
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x0f172a);

                camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
                camera.position.set(50, 50, 50);

                renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(container.clientWidth, container.clientHeight);
                container.innerHTML = '';
                container.appendChild(renderer.domElement);

                const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
                scene.add(ambientLight);

                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(50, 50, 50);
                scene.add(directionalLight);

                const gridHelper = new THREE.GridHelper(100, 20, 0x444444, 0x222222);
                scene.add(gridHelper);

                create3DNodes();
                animate3D();

                showNotification('3D ÏãúÍ∞ÅÌôîÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.', 'success');
            } catch (error) {
                showNotification('3D Ï¥àÍ∏∞Ìôî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
        }

        function create3DNodes() {
            nodeObjects.forEach(obj => scene.remove(obj));
            nodeObjects = [];

            nodeData.forEach((node, index) => {
                const angle = (index / nodeData.length) * Math.PI * 2;
                const radius = 30;
                const x = Math.cos(angle) * radius;
                const z = Math.sin(angle) * radius;

                const size = Math.max(0.5, node.connectedCables * 0.1);
                const geometry = new THREE.SphereGeometry(size, 16, 16);
                const material = new THREE.MeshLambertMaterial({ color: 0x3b82f6 });

                const nodeMesh = new THREE.Mesh(geometry, material);
                nodeMesh.position.set(x, 0, z);
                scene.add(nodeMesh);
                nodeObjects.push(nodeMesh);
            });
        }

        function animate3D() {
            if (renderer && scene && camera) {
                requestAnimationFrame(animate3D);
                renderer.render(scene, camera);
            }
        }

        function reset3DView() {
            if (camera) {
                camera.position.set(50, 50, 50);
                camera.lookAt(0, 0, 0);
            }
        }

        function toggle3DNodes() {
            const show = document.getElementById('showNodes')?.checked;
            nodeObjects.forEach(obj => { obj.visible = show; });
        }

        function toggle3DCables() {
            const show = document.getElementById('showCables')?.checked;
            cableObjects.forEach(obj => { obj.visible = show; });
        }

        function update3DRotation() {
            if (!scene) return;
            const rotX = document.getElementById('rotationX').value * Math.PI / 180;
            const rotY = document.getElementById('rotationY').value * Math.PI / 180;
            const rotZ = document.getElementById('rotationZ').value * Math.PI / 180;
            scene.rotation.set(rotX, rotY, rotZ);
        }

        function update3DZoom() {
            if (!camera) return;
            const zoom = parseFloat(document.getElementById('zoomLevel').value);
            camera.zoom = zoom;
            camera.updateProjectionMatrix();
        }

        // Î∂ÑÏÑù Î∞è Í≥ÑÏÇ∞ Ìï®ÏàòÎì§
        function calculateNodeUtilization() {
            calculateNodeConnections();
            updateNodeTable();

            const statsGrid = document.getElementById('nodeStatsGrid');
            statsGrid.innerHTML = '';

            const maxConnections = Math.max(...nodeData.map(n => n.connectedCables));
            const avgConnections = nodeData.reduce((sum, n) => sum + n.connectedCables, 0) / nodeData.length;
            const totalCrossSection = nodeData.reduce((sum, n) => sum + n.totalCrossSection, 0);

            const stats = [
                { label: 'ÏµúÎåÄ Ïó∞Í≤∞ ÏºÄÏù¥Î∏î', value: maxConnections },
                { label: 'ÌèâÍ∑† Ïó∞Í≤∞ ÏºÄÏù¥Î∏î', value: avgConnections.toFixed(1) },
                { label: 'Ï¥ù Îã®Î©¥Ï†Å (mm¬≤)', value: totalCrossSection.toFixed(2) },
                { label: 'Ïó∞Í≤∞ ÎÖ∏Îìú Ïàò', value: nodeData.filter(n => n.connectedCables > 0).length }
            ];

            stats.forEach(stat => {
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.innerHTML = `
                    <div class="stat-number">${stat.value}</div>
                    <div class="stat-label">${stat.label}</div>
                `;
                statsGrid.appendChild(card);
            });

            showNotification('ÎÖ∏Îìú Ïù¥Ïö©Î•†Ïù¥ Í≥ÑÏÇ∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function analyzeTypes() {
            updateTypeAnalysisChart();
            updateTypeTable();
            showNotification('ÌÉÄÏûÖ Î∂ÑÏÑùÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function calculateQuantities() {
            const quantityStats = calculateQuantityStats();

            let totalLength = 0;
            let totalWeight = 0;
            let totalCost = 0;

            Object.entries(quantityStats).forEach(([type, stats]) => {
                totalLength += stats.totalLength;
                totalWeight += stats.totalLength * getCableWeight(type);
                totalCost += stats.totalLength * getCableUnitPrice(type);
            });

            document.getElementById('totalCableLength').textContent = totalLength.toFixed(1);
            document.getElementById('totalWeight').textContent = totalWeight.toFixed(1);
            document.getElementById('totalCost').textContent = totalCost.toLocaleString();
            document.getElementById('uniqueTypes').textContent = Object.keys(quantityStats).length;

            updateQuantityChart();
            updateQuantityTable();

            showNotification('Î¨ºÎüâ Í≥ÑÏÇ∞Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        // ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ìï®ÏàòÎì§
        function downloadBlob(blob, filename) {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function convertToCSV(data, headers) {
            const csvHeaders = headers.join(',');
            const csvRows = data.map(row => 
                headers.map(header => JSON.stringify(row[header] || '')).join(',')
            );
            return [csvHeaders, ...csvRows].join('\n');
        }

        function exportData() {
            const exportData = {
                cables: cableData,
                nodes: nodeData,
                statistics: {
                    totalCables: cableData.length,
                    totalNodes: nodeData.length,
                    totalLength: cableData.reduce((sum, c) => sum + (c.length || 0), 0)
                },
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            downloadBlob(blob, 'seastar_cable_data.json');
            showNotification('Îç∞Ïù¥ÌÑ∞Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function exportCableList() {
            const csvData = convertToCSV(filteredCableData, ['name', 'type', 'system', 'fromNode', 'toNode', 'length', 'outDia']);
            const blob = new Blob([csvData], { type: 'text/csv' });
            downloadBlob(blob, 'cable_list.csv');
            showNotification('ÏºÄÏù¥Î∏î Î™©Î°ùÏù¥ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function exportNodeInfo() {
            const csvData = convertToCSV(nodeData, ['name', 'connectedCables', 'totalCrossSection', 'relation', 'linkLength']);
            const blob = new Blob([csvData], { type: 'text/csv' });
            downloadBlob(blob, 'node_info.csv');
            showNotification('ÎÖ∏Îìú Ï†ïÎ≥¥Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function exportTypeAnalysis() {
            const typeStats = calculateTypeStats();
            const data = Object.entries(typeStats).map(([type, stats]) => ({
                type, count: stats.count, totalLength: stats.totalLength,
                avgLength: stats.avgLength, avgOutDia: stats.avgOutDia, skinRange: stats.skinRange
            }));

            const csvData = convertToCSV(data, ['type', 'count', 'totalLength', 'avgLength', 'avgOutDia', 'skinRange']);
            const blob = new Blob([csvData], { type: 'text/csv' });
            downloadBlob(blob, 'type_analysis.csv');
            showNotification('ÌÉÄÏûÖ Î∂ÑÏÑù Í≤∞Í≥ºÍ∞Ä ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function exportQuantityReport() {
            const quantityStats = calculateQuantityStats();
            const data = Object.entries(quantityStats).map(([type, stats]) => ({
                type, count: stats.count, totalLength: stats.totalLength.toFixed(1),
                avgLength: stats.avgLength.toFixed(1), unitPrice: getCableUnitPrice(type),
                totalCost: (stats.totalLength * getCableUnitPrice(type)).toLocaleString()
            }));

            const csvData = convertToCSV(data, ['type', 'count', 'totalLength', 'avgLength', 'unitPrice', 'totalCost']);
            const blob = new Blob([csvData], { type: 'text/csv' });
            downloadBlob(blob, 'quantity_report.csv');
            showNotification('Î¨ºÎüâ Î≥¥Í≥†ÏÑúÍ∞Ä ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function generatePOSReport() {
            const quantityStats = calculateQuantityStats();
            let posReport = 'SEASTAR ÏºÄÏù¥Î∏î Î¨ºÎüâ ÏÇ∞Ï∂úÏÑú\n';
            posReport += 'ÏÉùÏÑ±Ïùº: ' + new Date().toLocaleDateString('ko-KR') + '\n\n';
            posReport += 'Ìï≠Î™©\tÏàòÎüâ\tÎã®ÏúÑ\tÎã®Í∞Ä(Ïõê)\tÍ∏àÏï°(Ïõê)\n';
            posReport += '='.repeat(50) + '\n';

            let totalAmount = 0;
            Object.entries(quantityStats).forEach(([type, stats]) => {
                const unitPrice = getCableUnitPrice(type);
                const amount = stats.totalLength * unitPrice;
                totalAmount += amount;
                posReport += `${type}\t${stats.totalLength.toFixed(1)}\tm\t${unitPrice.toLocaleString()}\t${amount.toLocaleString()}\n`;
            });

            posReport += '='.repeat(50) + '\n';
            posReport += `Ï¥ù Í∏àÏï°\t\t\t\t${totalAmount.toLocaleString()}Ïõê\n`;

            const blob = new Blob([posReport], { type: 'text/plain' });
            downloadBlob(blob, 'pos_report.txt');
            showNotification('POS Î≥¥Í≥†ÏÑúÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function export3DData() {
            const export3DData = {
                nodes: nodeData,
                cables: cableData,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(export3DData, null, 2)], { type: 'application/json' });
            downloadBlob(blob, '3d_network_data.json');
            showNotification('3D Îç∞Ïù¥ÌÑ∞Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        // Í≤ΩÎ°ú Í¥ÄÎ¶¨ Ìï®ÏàòÎì§
        function showCableRoute() {
            const selectedIndex = document.getElementById('cableSelect').value;
            if (selectedIndex !== '') {
                const cable = cableData[parseInt(selectedIndex)];
                showNotification(`${cable.name} Í≤ΩÎ°ú: ${cable.fromNode} ‚Üí ${cable.toNode}`, 'info');
            }
        }

        function editCableRoute() {
            showNotification('Í≤ΩÎ°ú Ìé∏Ïßë Î™®ÎìúÍ∞Ä ÌôúÏÑ±ÌôîÎêòÏóàÏäµÎãàÎã§.', 'info');
        }

        function saveCableRoute() {
            showNotification('Í≤ΩÎ°ú Î≥ÄÍ≤ΩÏÇ¨Ìï≠Ïù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function changeRoute() {
            const newFromNode = document.getElementById('newFromNode').value;
            const newToNode = document.getElementById('newToNode').value;
            const newLength = document.getElementById('newLength').value;

            if (newFromNode && newToNode && newLength) {
                showNotification(`Í≤ΩÎ°úÍ∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§: ${newFromNode} ‚Üí ${newToNode} (${newLength}m)`, 'success');
            } else {
                showNotification('Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
            }
        }

        function revertRoute() {
            document.getElementById('newFromNode').value = '';
            document.getElementById('newToNode').value = '';
            document.getElementById('newLength').value = '';
            showNotification('Í≤ΩÎ°ú Î≥ÄÍ≤ΩÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.', 'info');
        }

        function editRoute(index) {
            const cable = cableData[index];
            document.getElementById('newFromNode').value = cable.fromNode;
            document.getElementById('newToNode').value = cable.toNode;
            document.getElementById('newLength').value = cable.length;
            showNotification(`${cable.name} Í≤ΩÎ°ú Ìé∏Ïßë Î™®Îìú`, 'info');
        }

        function show3DNetwork() {
            showTab('3d');
            if (!renderer) {
                setTimeout(() => initialize3D(), 100);
            }
        }

        // ÏÉÅÏÑ∏Î≥¥Í∏∞ Ìï®ÏàòÎì§
        function editCable(index) {
            const cable = filteredCableData[index];
            showNotification(`ÏºÄÏù¥Î∏î ${cable.name} Ìé∏Ïßë Î™®Îìú`, 'info');
        }

        function viewCableDetail(index) {
            const cable = filteredCableData[index];
            alert(`ÏºÄÏù¥Î∏î ÏÉÅÏÑ∏ Ï†ïÎ≥¥:\nÏù¥Î¶Ñ: ${cable.name}\nÌÉÄÏûÖ: ${cable.type}\nÏãúÏä§ÌÖú: ${cable.system}\nÍ∏∏Ïù¥: ${cable.length}m\nÏïÑÏõÉÎã§Ïù¥Ïñ¥: ${cable.outDia}mm`);
        }

        function viewNodeDetail(index) {
            const node = nodeData[index];
            alert(`ÎÖ∏Îìú ÏÉÅÏÑ∏ Ï†ïÎ≥¥:\nÏù¥Î¶Ñ: ${node.name}\nÏó∞Í≤∞ ÏºÄÏù¥Î∏î: ${node.connectedCables}Í∞ú\nÏ¥ù Îã®Î©¥Ï†Å: ${node.totalCrossSection.toFixed(2)}mm¬≤\nÎßÅÌÅ¨ Í∏∏Ïù¥: ${node.linkLength}m`);
        }

        function viewTypeDetail(type) {
            const typeData = cableData.filter(c => c.type === type);
            alert(`${type} ÌÉÄÏûÖ ÏÉÅÏÑ∏:\nÏ¥ù Í∞úÏàò: ${typeData.length}Í∞ú\nÏ¥ù Í∏∏Ïù¥: ${typeData.reduce((sum, c) => sum + c.length, 0).toFixed(1)}m`);
        }

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function refreshAll() {
            updateAllData();
            if (renderer) initialize3D();
            showNotification('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÉàÎ°úÍ≥†Ïπ®ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function resetSystem() {
            if (confirm('ÏãúÏä§ÌÖúÏùÑ Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå? Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÇ≠Ï†úÎê©ÎãàÎã§.')) {
                cableData = [];
                nodeData = [];
                filteredCableData = [];

                Object.values(charts).forEach(chart => {
                    if (chart) chart.destroy();
                });
                charts = {};

                if (renderer && scene) scene.clear();

                updateAllData();
                showNotification('ÏãúÏä§ÌÖúÏù¥ Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.', 'info');
            }
        }

        // 30Ìöå Í∏∞Îä• ÌÖåÏä§Ìä∏ ÏãúÏä§ÌÖú
        function runAllTests() {
            testResults = [];
            const testDiv = document.getElementById('testResults');
            const contentDiv = document.getElementById('testContent');

            testDiv.className = 'notification info show';
            contentDiv.innerHTML = '<div>ÏãúÏä§ÌÖú ÌÖåÏä§Ìä∏ ÏßÑÌñâ Ï§ë...</div>';

            const tests = [
                { name: 'Îç∞Ïù¥ÌÑ∞ Î°úÎìú', func: () => loadSampleData() },
                { name: 'ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateStats() },
                { name: 'ÌïÑÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateFilters() },
                { name: 'ÏºÄÏù¥Î∏î ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateCableTable() },
                { name: 'ÎÖ∏Îìú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateNodeTable() },
                { name: 'ÌÉÄÏûÖ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateTypeTable() },
                { name: 'Í≤ΩÎ°ú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateRouteTable() },
                { name: 'Î¨ºÎüâ ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏', func: () => updateQuantityTable() },
                { name: 'ÏãúÏä§ÌÖú Ï∞®Ìä∏', func: () => updateSystemChart() },
                { name: 'ÌÉÄÏûÖ Ï∞®Ìä∏', func: () => updateTypeChart() },
                { name: 'ÎÖ∏Îìú Ï∞®Ìä∏', func: () => updateNodeChart() },
                { name: 'ÌÉÄÏûÖ Î∂ÑÏÑù Ï∞®Ìä∏', func: () => updateTypeAnalysisChart() },
                { name: 'Î¨ºÎüâ Ï∞®Ìä∏', func: () => updateQuantityChart() },
                { name: 'ÏºÄÏù¥Î∏î Í≤ÄÏÉâ', func: () => { document.getElementById('cableSearch').value = 'P3101'; searchCables(); } },
                { name: 'ÏºÄÏù¥Î∏î ÌïÑÌÑ∞ÎßÅ', func: () => { document.getElementById('systemFilter').value = 'POWER'; filterCables(); } },
                { name: 'ÎÖ∏Îìú Í≤ÄÏÉâ', func: () => { document.getElementById('nodeSearch').value = 'ER00'; searchNodes(); } },
                { name: 'Îπ†Î•∏ Í≤ÄÏÉâ', func: () => { document.getElementById('quickSearch').value = 'P3101'; quickSearch(); } },
                { name: 'ÎÖ∏Îìú Ïù¥Ïö©Î•† Í≥ÑÏÇ∞', func: () => calculateNodeUtilization() },
                { name: 'ÌÉÄÏûÖ Î∂ÑÏÑù', func: () => analyzeTypes() },
                { name: 'Î¨ºÎüâ Í≥ÑÏÇ∞', func: () => calculateQuantities() },
                { name: 'ÏºÄÏù¥Î∏î ÏÉÅÏÑ∏Î≥¥Í∏∞', func: () => viewCableDetail(0) },
                { name: 'ÎÖ∏Îìú ÏÉÅÏÑ∏Î≥¥Í∏∞', func: () => viewNodeDetail(0) },
                { name: 'ÌÉÄÏûÖ ÏÉÅÏÑ∏Î≥¥Í∏∞', func: () => viewTypeDetail('MC') },
                { name: 'Í≤ΩÎ°ú ÌëúÏãú', func: () => { document.getElementById('cableSelect').value = '0'; showCableRoute(); } },
                { name: 'Í≤ΩÎ°ú Ìé∏Ïßë', func: () => editCableRoute() },
                { name: '3D Ï¥àÍ∏∞Ìôî', func: () => initialize3D() },
                { name: '3D Î∑∞ Î¶¨ÏÖã', func: () => reset3DView() },
                { name: 'ÌÉ≠ Ï†ÑÌôò - ÎåÄÏãúÎ≥¥Îìú', func: () => showTab('dashboard') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - ÏºÄÏù¥Î∏î', func: () => showTab('cables') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - ÎÖ∏Îìú', func: () => showTab('nodes') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - ÌÉÄÏûÖ', func: () => showTab('types') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - 3D', func: () => showTab('3d') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - Í≤ΩÎ°ú', func: () => showTab('routing') },
                { name: 'ÌÉ≠ Ï†ÑÌôò - Î¨ºÎüâ', func: () => showTab('quantity') },
                { name: 'Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞', func: () => exportData() },
                { name: 'ÏºÄÏù¥Î∏î Î™©Î°ù ÎÇ¥Î≥¥ÎÇ¥Í∏∞', func: () => exportCableList() },
                { name: 'ÎÖ∏Îìú Ï†ïÎ≥¥ ÎÇ¥Î≥¥ÎÇ¥Í∏∞', func: () => exportNodeInfo() },
                { name: 'ÌÉÄÏûÖ Î∂ÑÏÑù ÎÇ¥Î≥¥ÎÇ¥Í∏∞', func: () => exportTypeAnalysis() },
                { name: 'Î¨ºÎüâ Î≥¥Í≥†ÏÑú ÎÇ¥Î≥¥ÎÇ¥Í∏∞', func: () => exportQuantityReport() },
                { name: 'POS Î≥¥Í≥†ÏÑú ÏÉùÏÑ±', func: () => generatePOSReport() },
                { name: '3D Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•', func: () => export3DData() },
                { name: 'Ï†ÑÏ≤¥ ÏÉàÎ°úÍ≥†Ïπ®', func: () => refreshAll() }
            ];

            let testIndex = 0;
            const runNextTest = () => {
                if (testIndex < tests.length) {
                    const test = tests[testIndex];
                    try {
                        test.func();
                        testResults.push({ name: test.name, result: '‚úÖ ÏÑ±Í≥µ', status: 'pass' });
                    } catch (error) {
                        testResults.push({ name: test.name, result: '‚ùå Ïã§Ìå®: ' + error.message, status: 'fail' });
                    }

                    testIndex++;
                    contentDiv.innerHTML = `
                        <div>ÌÖåÏä§Ìä∏ ÏßÑÌñâ: ${testIndex}/${tests.length}</div>
                        <div style="margin-top:10px;font-size:12px;max-height:200px;overflow-y:auto;">
                            ${testResults.map(r => `<div>${r.name}: ${r.result}</div>`).join('')}
                        </div>
                    `;

                    setTimeout(runNextTest, 100);
                } else {
                    const passCount = testResults.filter(r => r.status === 'pass').length;
                    const failCount = testResults.filter(r => r.status === 'fail').length;

                    contentDiv.innerHTML = `
                        <div style="font-weight:bold;">ÌÖåÏä§Ìä∏ ÏôÑÎ£å</div>
                        <div>ÏÑ±Í≥µ: ${passCount}, Ïã§Ìå®: ${failCount}</div>
                        <div style="margin-top:10px;font-size:12px;max-height:200px;overflow-y:auto;">
                            ${testResults.map(r => `<div>${r.name}: ${r.result}</div>`).join('')}
                        </div>
                    `;

                    testDiv.className = `notification ${failCount === 0 ? 'success' : 'warning'} show`;

                    setTimeout(() => {
                        testDiv.classList.remove('show');
                    }, 10000);

                    showNotification(`ÌÖåÏä§Ìä∏ ÏôÑÎ£å: ${passCount}Í∞ú ÏÑ±Í≥µ, ${failCount}Í∞ú Ïã§Ìå®`, failCount === 0 ? 'success' : 'warning');
                }
            };

            runNextTest();
        }

        // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'r': e.preventDefault(); refreshAll(); break;
                    case 's': e.preventDefault(); exportData(); break;
                    case '1': e.preventDefault(); showTab('dashboard'); break;
                    case '2': e.preventDefault(); showTab('cables'); break;
                    case '3': e.preventDefault(); showTab('nodes'); break;
                    case '4': e.preventDefault(); showTab('types'); break;
                    case '5': e.preventDefault(); showTab('3d'); break;
                    case '6': e.preventDefault(); showTab('routing'); break;
                    case '7': e.preventDefault(); showTab('quantity'); break;
                }
            }
        });

        // ÏúàÎèÑÏö∞ Î¶¨ÏÇ¨Ïù¥Ï¶à Ïù¥Î≤§Ìä∏
        window.addEventListener('resize', function() {
            if (renderer && camera) {
                const container = document.getElementById('threejsContainer');
                if (container) {
                    camera.aspect = container.clientWidth / container.clientHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(container.clientWidth, container.clientHeight);
                }
            }
        });

        console.log('üö¢ SEASTAR Ultimate Cable Management System ÏôÑÏ†Ñ Î°úÎìú ÏôÑÎ£å');
    </script>
</body>
</html>
